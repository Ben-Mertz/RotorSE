
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>3. Tutorial &#8212; RotorSE 0.1.0 documentation</title>
    <link rel="stylesheet" href="_static/nrel.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Documentation" href="documentation.html" />
    <link rel="prev" title="2. Installation" href="installation.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="documentation.html" title="4. Documentation"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="2. Installation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">RotorSE 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tutorial">
<span id="tutorial-label"></span><h1>3. Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline">¶</a></h1>
<p>NOTE: this tutorial needs to be updated when the full DTU10MW model is available.  Currently using the old composite layups.</p>
<p>The module <a class="reference internal" href="documentation.html#module-rotorse.rotor_aeropower" title="rotorse.rotor_aeropower"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.rotor_aeropower</span></code></a> contains methods for generating power curves and computing annual energy production (AEP) with any aerodynamic tool, any wind speed distribution (implementing <code class="xref py py-mod docutils literal notranslate"><span class="pre">PDFBase</span></code> and <code class="xref py py-mod docutils literal notranslate"><span class="pre">PDFBase</span></code>), any drivetrain efficiency function (implementing <code class="xref py py-mod docutils literal notranslate"><span class="pre">DrivetrainLossesBase</span></code>), and any machine type amongst the four combinations of variable/fixed speed and variable/fixed pitch.</p>
<p>The module <a class="reference internal" href="documentation.html#module-rotorse.rotor_geometry" title="rotorse.rotor_geometry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.rotor_geometry</span></code></a> provides specific implementations of reference rotor designs (implementing <code class="xref py py-mod docutils literal notranslate"><span class="pre">ReferenceBlade</span></code>).  <a class="reference external" href="https://github.com/WISDEM/CCBlade">CCBlade</a> is used for the aerodynamic analysis and <a class="reference external" href="https://github.com/WISDEM/CommonSE">CommonSE</a> provides Weibull and Rayleigh wind speed distribution.</p>
<p>The module <a class="reference internal" href="documentation.html#module-rotorse.rotor_structure" title="rotorse.rotor_structure"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.rotor_structure</span></code></a> provides structural analyses including methods for managing the composite secion analysis, computing deflections, computing mass properties, etc.  The module <a class="reference internal" href="documentation.html#module-rotorse.rotor" title="rotorse.rotor"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.rotor</span></code></a> provides the coupling between rotor_aeropower and rotor_sturucture for combined analysis.</p>
<p>Two examples are included in this tutorial section: aerodynamic simulation and optimization of a rotor and aero/structural analysis of a rotor.</p>
<div class="section" id="rotor-aerodynamics">
<h2>3.1. Rotor Aerodynamics<a class="headerlink" href="#rotor-aerodynamics" title="Permalink to this headline">¶</a></h2>
<p>This example is available at <a class="reference internal" href="documentation.html#module-rotorse.examples.rotorse_example1" title="rotorse.examples.rotorse_example1"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.examples.rotorse_example1</span></code></a> or can be viewed as an interactive Jupyter notebook _____.  The first step is to import the relevant files.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
		<span class="kn">import</span> <span class="nn">os</span>
		<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">Brent</span><span class="p">,</span> <span class="n">ScipyGMRES</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_aeropower</span> <span class="kn">import</span> <span class="n">RotorAeroPower</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_geometry</span> <span class="kn">import</span> <span class="n">RotorGeometry</span><span class="p">,</span> <span class="n">NREL5MW</span><span class="p">,</span> <span class="n">DTU10MW</span><span class="p">,</span> <span class="n">TUM3_35MW</span><span class="p">,</span> <span class="n">NINPUT</span>
		<span class="kn">from</span> <span class="nn">rotorse</span> <span class="kn">import</span> <span class="n">RPM2RS</span><span class="p">,</span> <span class="n">RS2RPM</span><span class="p">,</span> <span class="n">TURBULENCE_CLASS</span><span class="p">,</span> <span class="n">DRIVETRAIN_TYPE</span>
</pre></div>
</div>
<p>When setting up our Problem, a rotor design that is an implimentation of <code class="xref py py-mod docutils literal notranslate"><span class="pre">ReferenceBlade</span></code>, is used to initialize the Group.  Two reference turbine designs are included as examples in <a class="reference internal" href="documentation.html#module-rotorse.rotor_geometry" title="rotorse.rotor_geometry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.rotor_geometry</span></code></a>, the <code class="xref py py-mod docutils literal notranslate"><span class="pre">NREL5MW</span></code> and the <code class="xref py py-mod docutils literal notranslate"><span class="pre">DTU10MW</span></code>.  For this tutorial, we will be working with the DTU 10 MW.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>
		<span class="n">myref</span> <span class="o">=</span> <span class="n">TUM3_35MW</span><span class="p">()</span>

		<span class="n">npts_coarse_power_curve</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># (Int): number of points to evaluate aero analysis at</span>
		<span class="n">npts_spline_power_curve</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># (Int): number of points to use in fitting spline to power curve</span>

		<span class="n">rotor</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">RotorAeroPower</span><span class="p">(</span><span class="n">myref</span><span class="p">,</span> <span class="n">npts_coarse_power_curve</span><span class="p">,</span> <span class="n">npts_spline_power_curve</span><span class="p">,</span> <span class="n">regulation_reg_II5</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">regulation_reg_III</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>
</pre></div>
</div>
<p>A number of input variablers covering the blade geometry, atmospheric conditions, and controls system must be set by the use.  While the reference blade design provides this information, it must be again set at the Problem level.  This provides flexibility for modifications by the user or by an optimizer.  The user can choose to use the default values</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="c1"># === blade grid ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hubFraction</span> <span class="c1">#0.023785  # (Float): hub location as fraction of radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">bladeLength</span> <span class="c1">#96.7  # (Float, m): blade length (if not precurved or swept) otherwise length of blade before curvature</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">precone</span> <span class="c1">#4.  # (Float, deg): precone angle</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;tilt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">tilt</span> <span class="c1">#6.0  # (Float, deg): shaft tilt</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;yaw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): yaw error</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nBlades&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">nBlades</span> <span class="c1">#3  # (Int): number of blades</span>

		<span class="c1"># === blade geometry ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">r_max_chord</span> <span class="c1">#0.2366  # (Float): location of max chord on unit radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;chord_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">chord</span> <span class="c1">#np.array([4.6, 4.869795, 5.990629, 3.00785428, 0.0962])  # (Array, m): chord at control points. defined at hub, then at linearly spaced locations from r_max_chord to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;theta_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">theta</span> <span class="c1">#np.array([14.5, 12.874, 6.724, -0.03388039, -0.037])  # (Array, deg): twist at control points.  defined at linearly spaced locations from r[idx_cylinder] to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">precurve</span> <span class="c1">#np.array([-0., -0.054497, -0.175303, -0.84976143, -6.206217])  # (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">presweep</span> <span class="c1">#np.array([0., 0., 0., 0., 0.])  # (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">spar_thickness</span> <span class="c1">#np.array([0.03200042 0.07038508 0.08515644 0.07777004 0.01181032])  # (Array, m): spar cap thickness parameters</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;teT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">te_thickness</span> <span class="c1">#np.array([0.04200055 0.08807739 0.05437378 0.01610219 0.00345225])  # (Array, m): trailing-edge thickness parameters</span>

		<span class="c1"># === atmosphere ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.225</span>  <span class="c1"># (Float, kg/m**3): density of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.81206e-5</span>  <span class="c1"># (Float, kg/m/s): dynamic viscosity of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hub_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hub_height</span> <span class="c1">#119.0</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;shearExp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># (Float): shear exponent</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">turbine_class</span> <span class="c1">#TURBINE_CLASS[&#39;I&#39;]  # (Enum): IEC turbine class</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;cdf_reference_height_wind_speed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hub_height</span> <span class="c1">#119.0  # (Float): reference hub height for IEC wind speed (used in CDF calculation)</span>

		<span class="c1"># === control ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_Vin</span> <span class="c1">#4.0  # (Float, m/s): cut-in wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_Vout</span> <span class="c1">#25.0  # (Float, m/s): cut-out wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_ratedPower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">rating</span> <span class="c1">#10e6  # (Float, W): rated power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_minOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_minOmega</span> <span class="c1">#6.0  # (Float, rpm): minimum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_maxOmega</span> <span class="c1">#8.88766  # (Float, rpm): maximum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxTS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_maxTS</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_tsr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_tsr</span> <span class="c1">#10.58  # (Float): tip-speed ratio in Region 2 (should be optimized externally)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_pitch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_pitch</span> <span class="c1">#0.0  # (Float, deg): pitch angle in region 2 (and region 3 for fixed pitch machines)</span>

		<span class="c1"># === aero and structural analysis options ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nSector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># (Int): number of sectors to divide rotor face into in computing thrust and power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;AEP_loss_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># (Float): availability and other losses (soiling, array, etc.)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;drivetrainType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">drivetrain</span> <span class="c1">#DRIVETRAIN_TYPE[&#39;GEARED&#39;]  # (Enum)</span>
</pre></div>
</div>
<p>Or set their own values.  First, the geometry is defined.  Spanwise blade variables such as chord and twist are definied using control points, which <code class="xref py py-class docutils literal notranslate"><span class="pre">BladeGeometry</span></code> uses to generate the spanwise distribution using Akima splines according to <a class="pageref" href="#chord-param-fig">Figures  1</a> and <a class="pageref" href="#twist-param-fig"> 2</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.023785</span>  <span class="c1"># (Float): hub location as fraction of radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">96.7</span>  <span class="c1"># (Float, m): blade length (if not precurved or swept) otherwise length of blade before curvature</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.</span>  <span class="c1"># (Float, deg): precone angle</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;tilt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span>  <span class="c1"># (Float, deg): shaft tilt</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;yaw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): yaw error</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nBlades&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># (Int): number of blades</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2366</span>  <span class="c1"># (Float): location of max chord on unit radius</span>

		<span class="c1"># Control points</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;chord_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">4.6</span><span class="p">,</span> <span class="mf">4.869795</span><span class="p">,</span> <span class="mf">5.990629</span><span class="p">,</span> <span class="mf">3.00785428</span><span class="p">,</span> <span class="mf">0.0962</span><span class="p">])</span>  <span class="c1"># (Array, m): chord at control points. defined at hub, then at linearly spaced locations from r_max_chord to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;theta_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">14.5</span><span class="p">,</span> <span class="mf">12.874</span><span class="p">,</span> <span class="mf">6.724</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.03388039</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.037</span><span class="p">])</span>  <span class="c1"># (Array, deg): twist at control points.  defined at linearly spaced locations from r[idx_cylinder] to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.054497</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.175303</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.84976143</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.206217</span><span class="p">])</span>  <span class="c1"># (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>  <span class="c1"># (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.03200042</span><span class="p">,</span> <span class="mf">0.07038508</span><span class="p">,</span> <span class="mf">0.08515644</span><span class="p">,</span> <span class="mf">0.07777004</span><span class="p">,</span> <span class="mf">0.01181032</span><span class="p">])</span>  <span class="c1"># (Array, m): spar cap thickness parameters</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;teT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.04200055</span><span class="p">,</span> <span class="mf">0.08807739</span><span class="p">,</span> <span class="mf">0.05437378</span><span class="p">,</span> <span class="mf">0.01610219</span><span class="p">,</span> <span class="mf">0.00345225</span><span class="p">])</span>  <span class="c1"># (Array, m): trailing-edge thickness parameters</span>
</pre></div>
</div>
<div class="figure align-left" id="id1">
<span id="chord-param-fig"></span><a class="reference internal image-reference" href="_images/chord_dtu10mw.png"><img alt="_images/chord_dtu10mw.png" src="_images/chord_dtu10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 1: Chord parameterization</span></p>
</div>
<div class="figure align-center" id="id2">
<span id="twist-param-fig"></span><a class="reference internal image-reference" href="_images/theta_dtu10mw.png"><img alt="_images/theta_dtu10mw.png" src="_images/theta_dtu10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 2: Twist parameterization</span></p>
</div>
<p>Atmospheric properties are defined.  The wind speed distribution parameters are determined based on the wind turbine class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.225</span>  <span class="c1"># (Float, kg/m**3): density of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.81206e-5</span>  <span class="c1"># (Float, kg/m/s): dynamic viscosity of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hub_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">119.</span> <span class="c1"># (Float, m)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;shearExp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># (Float): shear exponent</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span>  <span class="c1"># (Enum): IEC turbine class</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;cdf_reference_height_wind_speed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">119.</span>   <span class="c1"># (Float): reference hub height for IEC wind speed (used in CDF calculation)</span>
</pre></div>
</div>
<p>The relevant control parameters are set</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>  <span class="c1"># (Float, m/s): cut-in wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">25.0</span>  <span class="c1"># (Float, m/s): cut-out wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_ratedPower&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.e6</span>  <span class="c1"># (Float, W): rated power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_minOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.0</span>  <span class="c1"># (Float, rpm): minimum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">8.88766</span>  <span class="c1"># (Float, rpm): maximum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxTS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">80.0</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_tsr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.58</span>  <span class="c1"># (Float): tip-speed ratio in Region 2 (should be optimized externally)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_pitch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): pitch angle in region 2 (and region 3 for fixed pitch machines)</span>
</pre></div>
</div>
<p>Finally, a few configuation parameters are set.  The the following drivetrain types are supported: ‘geared’, ‘single_stage’, ‘multi_drive’, or ‘pm_direct_drive’.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nSector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># (Int): number of sectors to divide rotor face into in computing thrust and power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;AEP_loss_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># (Float): availability and other losses (soiling, array, etc.)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;drivetrainType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DRIVETRAIN_TYPE</span><span class="p">[</span><span class="s1">&#39;GEARED&#39;</span><span class="p">]</span>  <span class="c1"># (Enum)</span>
</pre></div>
</div>
<p>We can now run the analysis, print the outputs, and plot the power curve.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;AEP =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;AEP&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;diameter =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;diameter&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ratedConditions.V =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_V&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ratedConditions.Omega =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_Omega&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ratedConditions.pitch =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_pitch&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ratedConditions.T =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_T&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;ratedConditions.Q =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_Q&#39;</span><span class="p">])</span>

		<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed (m/s)&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power (MW)&#39;</span><span class="p">)</span>
		<span class="c1"># plt.show()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AEP</span> <span class="o">=</span> <span class="mf">46811339.16312428</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span> <span class="o">=</span> <span class="mf">197.51768195144518</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratedConditions</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="mf">11.674033110109226</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratedConditions</span><span class="o">.</span><span class="n">Omega</span> <span class="o">=</span> <span class="mf">8.887659696962098</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratedConditions</span><span class="o">.</span><span class="n">pitch</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratedConditions</span><span class="o">.</span><span class="n">T</span> <span class="o">=</span> <span class="mf">1514792.8710181064</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratedConditions</span><span class="o">.</span><span class="n">Q</span> <span class="o">=</span> <span class="mf">10744444.444444444</span>
</pre></div>
</div>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/power_curve_dtu10mw.png"><img alt="_images/power_curve_dtu10mw.png" src="_images/power_curve_dtu10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 3: Power curve</span></p>
</div>
</div>
<div class="section" id="rotor-aerodynamics-optimization">
<h2>3.2. Rotor Aerodynamics Optimization<a class="headerlink" href="#rotor-aerodynamics-optimization" title="Permalink to this headline">¶</a></h2>
<p>This section describes a simple optimization continuing off of the same setup as the previous section.  This example is available at <a class="reference internal" href="documentation.html#module-rotorse.examples.rotorse_example2" title="rotorse.examples.rotorse_example2"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.examples.rotorse_example2</span></code></a> or can be viewed as an interactive Jupyter notebook _____.  First, we import relevant modules and initialize the problem.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
		<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
		<span class="kn">import</span> <span class="nn">os</span>
		<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">Brent</span><span class="p">,</span> <span class="n">ScipyGMRES</span><span class="p">,</span> <span class="n">ScipyOptimizer</span><span class="p">,</span> <span class="n">DumpRecorder</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_aeropower</span> <span class="kn">import</span> <span class="n">RotorAeroPower</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_geometry</span> <span class="kn">import</span> <span class="n">RotorGeometry</span><span class="p">,</span> <span class="n">NREL5MW</span><span class="p">,</span> <span class="n">DTU10MW</span><span class="p">,</span> <span class="n">TUM3_35MW</span><span class="p">,</span> <span class="n">NINPUT</span>
		<span class="kn">from</span> <span class="nn">rotorse</span> <span class="kn">import</span> <span class="n">RPM2RS</span><span class="p">,</span> <span class="n">RS2RPM</span><span class="p">,</span> <span class="n">TURBULENCE_CLASS</span><span class="p">,</span> <span class="n">DRIVETRAIN_TYPE</span>

		<span class="n">rotor</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>
		<span class="n">myref</span> <span class="o">=</span> <span class="n">TUM3_35MW</span><span class="p">()</span>

		<span class="n">npts_coarse_power_curve</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># (Int): number of points to evaluate aero analysis at</span>
		<span class="n">npts_spline_power_curve</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># (Int): number of points to use in fitting spline to power curve</span>

		<span class="n">rotor</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">RotorAeroPower</span><span class="p">(</span><span class="n">myref</span><span class="p">,</span> <span class="n">npts_coarse_power_curve</span><span class="p">,</span> <span class="n">npts_spline_power_curve</span><span class="p">,</span> <span class="n">regulation_reg_II5</span> <span class="o">=</span> <span class="bp">False</span><span class="p">,</span> <span class="n">regulation_reg_III</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The optimizer must be selected and configured, in this example I choose SLSQP.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span> <span class="o">=</span> <span class="n">ScipyOptimizer</span><span class="p">()</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;optimizer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;SLSQP&#39;</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;tol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0e-8</span>
</pre></div>
</div>
<p>We now set the objective, and in this example it is normalized by the starting AEP for better convergence behavior.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">AEP0</span> <span class="o">=</span> <span class="mf">13228756.289082643</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_objective</span><span class="p">(</span><span class="s1">&#39;AEP&#39;</span><span class="p">,</span> <span class="n">scaler</span><span class="o">=-</span><span class="mf">1.</span><span class="o">/</span><span class="n">AEP0</span><span class="p">)</span>
</pre></div>
</div>
<p>The rotor chord, twist, and tip-speed ratio in Region 2 are added as design variables.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_desvar</span><span class="p">(</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span> <span class="c1"># 0.2366</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_desvar</span><span class="p">(</span><span class="s1">&#39;chord_in&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">7.</span><span class="p">)</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_desvar</span><span class="p">(</span><span class="s1">&#39;theta_in&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=-</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">30.0</span><span class="p">)</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_desvar</span><span class="p">(</span><span class="s1">&#39;control_tsr&#39;</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="mf">14.0</span><span class="p">)</span>

		<span class="n">T0</span> <span class="o">=</span> <span class="mf">652703.2929159765</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_constraint</span><span class="p">(</span><span class="s1">&#39;rated_T&#39;</span><span class="p">,</span><span class="n">upper</span><span class="o">=</span><span class="n">T0</span><span class="o">*</span><span class="mf">1.02</span><span class="p">)</span>
</pre></div>
</div>
<p>A recorder is added to display each iteration to the screen.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rec</span> <span class="o">=</span> <span class="n">DumpRecorder</span><span class="p">()</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">driver</span><span class="o">.</span><span class="n">add_recorder</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
		<span class="n">rec</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;record_metadata&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">rec</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;record_unknowns&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">rec</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;record_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
		<span class="n">rec</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;includes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">,</span> <span class="s1">&#39;chord_in&#39;</span><span class="p">,</span> <span class="s1">&#39;theta_in&#39;</span><span class="p">,</span> <span class="s1">&#39;control_tsr&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>Input variables must be set, see previous example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

		<span class="c1"># === blade grid ===</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hubFraction</span> <span class="c1">#0.025  # (Float): hub location as fraction of radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">bladeLength</span> <span class="c1">#61.5  # (Float, m): blade length (if not precurved or swept) otherwise length of blade before curvature</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">precone</span> <span class="c1">#2.5  # (Float, deg): precone angle</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;tilt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">tilt</span> <span class="c1">#5.0  # (Float, deg): shaft tilt</span>
		<span class="c1"># ...</span>
</pre></div>
</div>
<p>Running the optimization (may take several minutes) yields a new design with a 4.83% percent increase in AEP.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Max</span> <span class="n">Chord</span> <span class="n">Radius</span> <span class="o">=</span>  <span class="mf">0.15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Chord</span> <span class="n">Control</span> <span class="n">Points</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">4.34251278</span> <span class="mf">5.86333664</span> <span class="mf">4.73321059</span> <span class="mf">2.69928949</span> <span class="mf">1.02802714</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Twist</span> <span class="n">Control</span> <span class="n">Points</span> <span class="o">=</span>  <span class="p">[</span><span class="mf">14.43318815</span> <span class="mf">13.24959516</span>  <span class="mf">9.19134204</span>  <span class="mf">0.44825328</span> <span class="o">-</span><span class="mf">3.17382031</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TSR</span> <span class="o">=</span>  <span class="mf">10.227899944164527</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">----------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Objective</span> <span class="o">=</span>  <span class="o">-</span><span class="mf">1.0483339663298121</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AEP</span> <span class="o">=</span>  <span class="mf">50439020.74897289</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Rated</span> <span class="n">Thrust</span> <span class="o">=</span> <span class="mf">1477743.3251388562</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Thrust</span> <span class="n">percent</span> <span class="n">change</span> <span class="o">=</span> <span class="mf">1.9999996705035588</span>
</pre></div>
</div>
<div class="figure align-left" id="id4">
<span id="chord-param-opt-fig"></span><a class="reference internal image-reference" href="_images/chord_opt_10mw.png"><img alt="_images/chord_opt_10mw.png" src="_images/chord_opt_10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 4: Optimized Chord</span></p>
</div>
<div class="figure align-center" id="id5">
<span id="twist-param-opt-fig"></span><a class="reference internal image-reference" href="_images/theta_opt_10mw.png"><img alt="_images/theta_opt_10mw.png" src="_images/theta_opt_10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 5: Optimized Twist</span></p>
</div>
</div>
<div class="section" id="rotor-aero-structures">
<h2>3.3. Rotor Aero/Structures<a class="headerlink" href="#rotor-aero-structures" title="Permalink to this headline">¶</a></h2>
<p>This examples includes both aerodynamic and structural analysis.  It is available at <a class="reference internal" href="documentation.html#module-rotorse.examples.rotorse_example3" title="rotorse.examples.rotorse_example3"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rotorse.examples.rotorse_example3</span></code></a> or can be viewed as an interactive Jupyter notebook _____.  In this case, they are not fully coupled.  The aerodynamic loads feed into the structural analysis, but there is no feedback from the structural deflections.  We first import the modules we will use and instantiate the objects.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
		<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
		<span class="kn">import</span> <span class="nn">os</span>
		<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="kn">import</span> <span class="n">IndepVarComp</span><span class="p">,</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">Problem</span><span class="p">,</span> <span class="n">Brent</span><span class="p">,</span> <span class="n">ScipyGMRES</span><span class="p">,</span> <span class="n">ScipyOptimizer</span><span class="p">,</span> <span class="n">DumpRecorder</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_aeropower</span> <span class="kn">import</span> <span class="n">RotorAeroPower</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor_geometry</span> <span class="kn">import</span> <span class="n">RotorGeometry</span><span class="p">,</span> <span class="n">NREL5MW</span><span class="p">,</span> <span class="n">DTU10MW</span><span class="p">,</span> <span class="n">TUM3_35MW</span><span class="p">,</span> <span class="n">NINPUT</span>
		<span class="kn">from</span> <span class="nn">rotorse</span> <span class="kn">import</span> <span class="n">RPM2RS</span><span class="p">,</span> <span class="n">RS2RPM</span><span class="p">,</span> <span class="n">TURBULENCE_CLASS</span><span class="p">,</span> <span class="n">DRIVETRAIN_TYPE</span>
		<span class="kn">from</span> <span class="nn">rotorse.rotor</span> <span class="kn">import</span> <span class="n">RotorSE</span>

		<span class="n">myref</span> <span class="o">=</span> <span class="n">TUM3_35MW</span><span class="p">()</span>

		<span class="n">rotor</span> <span class="o">=</span> <span class="n">Problem</span><span class="p">()</span>
		<span class="n">npts_coarse_power_curve</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># (Int): number of points to evaluate aero analysis at</span>
		<span class="n">npts_spline_power_curve</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># (Int): number of points to use in fitting spline to power curve</span>

		<span class="n">rotor</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="n">RotorSE</span><span class="p">(</span><span class="n">myref</span><span class="p">,</span> <span class="n">npts_coarse_power_curve</span><span class="p">,</span> <span class="n">npts_spline_power_curve</span><span class="p">)</span>
		<span class="n">rotor</span><span class="o">.</span><span class="n">setup</span><span class="p">()</span>

</pre></div>
</div>
<p>Initial grids are set.  From these definitions only changes to the aerodynamic grid needs to be specified (through <code class="docutils literal notranslate"><span class="pre">r_aero</span></code> in the next section) and the locations along the aerodynamic and structural grids will be kept in sync.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hubFraction</span> <span class="c1">#0.023785  # (Float): hub location as fraction of radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">bladeLength</span> <span class="c1">#96.7  # (Float, m): blade length (if not precurved or swept) otherwise length of blade before curvature</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">precone</span> <span class="c1">#4.  # (Float, deg): precone angle</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;tilt&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">tilt</span> <span class="c1">#6.0  # (Float, deg): shaft tilt</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;yaw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): yaw error</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nBlades&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">nBlades</span> <span class="c1">#3  # (Int): number of blades</span>
</pre></div>
</div>
<p>Next, geometric parameters are defined.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">myref</span><span class="o">.</span><span class="n">r_max_chord</span>  <span class="c1"># 0.2366 #(Float): location of max chord on unit radius</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;chord_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">chord</span> <span class="c1"># np.array([4.6, 4.869795, 5.990629, 3.00785428, 0.0962])  # (Array, m): chord at control points. defined at hub, then at linearly spaced locations from r_max_chord to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;theta_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">theta</span> <span class="c1"># np.array([14.5, 12.874, 6.724, -0.03388039, -0.037]) # (Array, deg): twist at control points.  defined at linearly spaced locations from r[idx_cylinder] to tip</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">precurve</span> <span class="c1">#np.array([-0., -0.054497, -0.175303, -0.84976143, -6.206217])  # (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">presweep</span> <span class="c1">#np.array([0., 0., 0., 0., 0.])  # (Array, m): precurve at control points.  defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">spar_thickness</span> <span class="c1"># np.array([0.03200042 0.07038508 0.08515644 0.07777004 0.01181032])  # (Array, m): spar cap thickness parameters</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;teT_in&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">te_thickness</span> <span class="c1"># np.array([0.04200055 0.08807739 0.05437378 0.01610219 0.00345225])  # (Array, m): trailing-edge thickness parameters</span>
</pre></div>
</div>
<p>The atmospheric data also includes defining the IEC turbine and turbulence class, which are used to compute the average wind speed for the site and the survival wind speed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.225</span>  <span class="c1"># (Float, kg/m**3): density of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;mu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.81206e-5</span>  <span class="c1"># (Float, kg/m/s): dynamic viscosity of air</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;wind.shearExp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25</span>  <span class="c1"># (Float): shear exponent</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;hub_height&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hub_height</span> <span class="c1">#119.0  # (Float, m): hub height</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">turbine_class</span> <span class="c1">#TURBINE_CLASS[&#39;I&#39;]  # (Enum): IEC turbine class</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;turbulence_class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">TURBULENCE_CLASS</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>  <span class="c1"># (Enum): IEC turbulence class class</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;wind.zref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">hub_height</span> <span class="c1">#119.0  # (Float): reference hub height for IEC wind speed (used in CDF calculation)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;gust_stddev&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Parameters are defined for the steady-state control conditions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vin&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_Vin</span> <span class="c1">#4.0  # (Float, m/s): cut-in wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_Vout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_Vout</span> <span class="c1">#25.0  # (Float, m/s): cut-out wind speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_minOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_minOmega</span> <span class="c1">#6.0  # (Float, rpm): minimum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxOmega&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_maxOmega</span> <span class="c1">#8.88766  # (Float, rpm): maximum allowed rotor rotation speed</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_tsr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_tsr</span> <span class="c1">#10.58  # (Float): tip-speed ratio in Region 2 (should be optimized externally)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_pitch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_pitch</span> <span class="c1">#0.0  # (Float, deg): pitch angle in region 2 (and region 3 for fixed pitch machines)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;control_maxTS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">control_maxTS</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;machine_rating&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">rating</span> <span class="c1">#10e6  # (Float, W): rated power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;pitch_extreme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): worst-case pitch at survival wind condition</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;azimuth_extreme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># (Float, deg): worst-case azimuth at survival wind condition</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;VfactorPC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span>  <span class="c1"># (Float): fraction of rated speed at which the deflection is assumed to representative throughout the power curve calculation</span>
</pre></div>
</div>
<p>Various optional parameters for the analysis can be defined.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;nSector&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># (Int): number of sectors to divide rotor face into in computing thrust and power</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;AEP_loss_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># (Float): availability and other losses (soiling, array, etc.)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;drivetrainType&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">myref</span><span class="o">.</span><span class="n">drivetrain</span> <span class="c1">#DRIVETRAIN_TYPE[&#39;GEARED&#39;]  # (Enum)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;dynamic_amplication_tip_deflection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.35</span>  <span class="c1"># (Float): a dynamic amplification factor to adjust the static deflection calculation</span>
</pre></div>
</div>
<p>A simplistic fatigue analysis can be done if damage equivalent moments are supplied.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">r_aero</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.02222276</span><span class="p">,</span> <span class="mf">0.06666667</span><span class="p">,</span> <span class="mf">0.11111057</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.23333333</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.36666667</span><span class="p">,</span> <span class="mf">0.43333333</span><span class="p">,</span>
		               <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.56666667</span><span class="p">,</span> <span class="mf">0.63333333</span><span class="p">,</span> <span class="mf">0.64</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.83333333</span><span class="p">,</span> <span class="mf">0.88888943</span><span class="p">,</span> <span class="mf">0.93333333</span><span class="p">,</span>
		               <span class="mf">0.97777724</span><span class="p">])</span>  <span class="c1"># (Array): new aerodynamic grid on unit radius</span>
		<span class="n">rstar_damage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.000</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">,</span> <span class="mf">0.067</span><span class="p">,</span> <span class="mf">0.111</span><span class="p">,</span> <span class="mf">0.167</span><span class="p">,</span> <span class="mf">0.233</span><span class="p">,</span> <span class="mf">0.300</span><span class="p">,</span> <span class="mf">0.367</span><span class="p">,</span> <span class="mf">0.433</span><span class="p">,</span> <span class="mf">0.500</span><span class="p">,</span>
		    <span class="mf">0.567</span><span class="p">,</span> <span class="mf">0.633</span><span class="p">,</span> <span class="mf">0.700</span><span class="p">,</span> <span class="mf">0.767</span><span class="p">,</span> <span class="mf">0.833</span><span class="p">,</span> <span class="mf">0.889</span><span class="p">,</span> <span class="mf">0.933</span><span class="p">,</span> <span class="mf">0.978</span><span class="p">])</span>  <span class="c1"># (Array): nondimensional radial locations of damage equivalent moments</span>
		<span class="n">Mxb_damage</span> <span class="o">=</span> <span class="mf">1e3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.3743E+003</span><span class="p">,</span> <span class="mf">2.0834E+003</span><span class="p">,</span> <span class="mf">1.8108E+003</span><span class="p">,</span> <span class="mf">1.5705E+003</span><span class="p">,</span> <span class="mf">1.3104E+003</span><span class="p">,</span>
		    <span class="mf">1.0488E+003</span><span class="p">,</span> <span class="mf">8.2367E+002</span><span class="p">,</span> <span class="mf">6.3407E+002</span><span class="p">,</span> <span class="mf">4.7727E+002</span><span class="p">,</span> <span class="mf">3.4804E+002</span><span class="p">,</span> <span class="mf">2.4458E+002</span><span class="p">,</span> <span class="mf">1.6339E+002</span><span class="p">,</span>
		    <span class="mf">1.0252E+002</span><span class="p">,</span> <span class="mf">5.7842E+001</span><span class="p">,</span> <span class="mf">2.7349E+001</span><span class="p">,</span> <span class="mf">1.1262E+001</span><span class="p">,</span> <span class="mf">3.8549E+000</span><span class="p">,</span> <span class="mf">4.4738E-001</span><span class="p">])</span>  <span class="c1"># (Array, N*m): damage equivalent moments about blade c.s. x-direction</span>
		<span class="n">Myb_damage</span> <span class="o">=</span> <span class="mf">1e3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.7732E+003</span><span class="p">,</span> <span class="mf">2.8155E+003</span><span class="p">,</span> <span class="mf">2.6004E+003</span><span class="p">,</span> <span class="mf">2.3933E+003</span><span class="p">,</span> <span class="mf">2.1371E+003</span><span class="p">,</span>
		    <span class="mf">1.8459E+003</span><span class="p">,</span> <span class="mf">1.5582E+003</span><span class="p">,</span> <span class="mf">1.2896E+003</span><span class="p">,</span> <span class="mf">1.0427E+003</span><span class="p">,</span> <span class="mf">8.2015E+002</span><span class="p">,</span> <span class="mf">6.2449E+002</span><span class="p">,</span> <span class="mf">4.5229E+002</span><span class="p">,</span>
		    <span class="mf">3.0658E+002</span><span class="p">,</span> <span class="mf">1.8746E+002</span><span class="p">,</span> <span class="mf">9.6475E+001</span><span class="p">,</span> <span class="mf">4.2677E+001</span><span class="p">,</span> <span class="mf">1.5409E+001</span><span class="p">,</span> <span class="mf">1.8426E+000</span><span class="p">])</span>  <span class="c1"># (Array, N*m): damage equivalent moments about blade c.s. y-direction</span>
		<span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">r_aero</span><span class="p">]</span>
		<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">myref</span><span class="o">.</span><span class="n">r</span><span class="p">]</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rstar_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">rstar_damage</span><span class="p">)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;Mxb_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">Mxb_damage</span><span class="p">)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;Myb_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">xp</span><span class="p">,</span> <span class="n">Myb_damage</span><span class="p">)</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strain_ult_spar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0e-2</span>  <span class="c1"># (Float): ultimate strain in spar cap</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strain_ult_te&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2500</span><span class="o">*</span><span class="mf">1e-6</span> <span class="o">*</span> <span class="mi">2</span>   <span class="c1"># (Float): uptimate strain in trailing-edge panels, note that I am putting a factor of two for the damage part only.</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;gamma_fatigue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.755</span> <span class="c1"># (Float): safety factor for fatigue</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;gamma_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.35</span> <span class="c1"># (Float): safety factor for loads/stresses</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;gamma_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="c1"># (Float): safety factor for materials</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;gamma_freq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span> <span class="c1"># (Float): safety factor for resonant frequencies</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;m_damage&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span>  <span class="c1"># (Float): slope of S-N curve for fatigue analysis</span>
		<span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;struc.lifetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.0</span>  <span class="c1"># (Float): number of cycles used in fatigue analysis  TODO: make function of rotation speed</span>
</pre></div>
</div>
<p>Finally, we run the assembly and print/plot some of the outputs.  <a class="pageref" href="#strain-spar-fig">Figures  6</a> and <a class="pageref" href="#strain-te-fig"> 7</a> show the strian distributions for the suction and pressure surface, as well as the critical strain load for buckling, in both the spar caps and trailing-edge panels.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>		<span class="n">rotor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;AEP =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;AEP&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;diameter =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;diameter&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;rated_V =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_V&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;rated_Omega =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_Omega&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;rated_pitch =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_pitch&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;rated_T =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_T&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;rated_Q =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;rated_Q&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;mass_one_blade =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;mass_one_blade&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;mass_all_blades =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;mass_all_blades&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;I_all_blades =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;I_all_blades&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;freq =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;freq&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;tip_deflection =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;tip_deflection&#39;</span><span class="p">])</span>
		<span class="k">print</span><span class="p">(</span><span class="s1">&#39;root_bending_moment =&#39;</span><span class="p">,</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;root_bending_moment&#39;</span><span class="p">])</span>

		<span class="n">outpath</span> <span class="o">=</span> <span class="s1">&#39;..\..\..\docs\images&#39;</span>
		<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">1e6</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;wind speed (m/s)&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;power (W)&#39;</span><span class="p">)</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strainU_spar&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;suction&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strainL_spar&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;eps_crit_spar&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
		<span class="c1"># plt.ylim([-6e-3, 6e-3])</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span><span class="s1">&#39;strain_spar_dtu10mw.png&#39;</span><span class="p">)))</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span><span class="s1">&#39;strain_spar_dtu10mw.pdf&#39;</span><span class="p">)))</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strainU_te&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;suction&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;strainL_te&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">],</span> <span class="n">rotor</span><span class="p">[</span><span class="s1">&#39;eps_crit_te&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;critical&#39;</span><span class="p">)</span>
		<span class="c1"># plt.ylim([-5e-3, 5e-3])</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;strain&#39;</span><span class="p">)</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span><span class="s1">&#39;strain_te_dtu10mw.png&#39;</span><span class="p">)))</span>
		<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span><span class="s1">&#39;strain_te_dtu10mw.pdf&#39;</span><span class="p">)))</span>

		<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AEP</span> <span class="o">=</span> <span class="mf">48113504.25433461</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diameter</span> <span class="o">=</span> <span class="mf">197.51768195144518</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rated_V</span> <span class="o">=</span> <span class="mf">11.489317285434028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rated_Omega</span> <span class="o">=</span> <span class="mf">8.887659696962098</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rated_pitch</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rated_T</span> <span class="o">=</span> <span class="mf">1448767.9705024462</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rated_Q</span> <span class="o">=</span> <span class="mf">10744444.444444444</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass_one_blade</span> <span class="o">=</span> <span class="mf">41104.297487659685</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass_all_blades</span> <span class="o">=</span> <span class="mf">123312.89246297906</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">I_all_blades</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.55254884e+08</span> <span class="mf">7.41578819e+07</span> <span class="mf">5.82484184e+07</span> <span class="mf">0.0e+00</span> <span class="mf">0.0e+00</span> <span class="mf">0.0e+00</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.53916149</span> <span class="mf">0.84197813</span> <span class="mf">1.21966084</span> <span class="mf">2.09334462</span> <span class="mf">2.15778794</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tip_deflection</span> <span class="o">=</span> <span class="mf">38.41878836125684</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root_bending_moment</span> <span class="o">=</span> <span class="mf">38539069.00864485</span>
</pre></div>
</div>
<div class="figure align-left" id="id6">
<span id="strain-spar-fig"></span><a class="reference internal image-reference" href="_images/strain_spar_dtu10mw.png"><img alt="_images/strain_spar_dtu10mw.png" src="_images/strain_spar_dtu10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 6: Strain in spar cap</span></p>
</div>
<div class="figure align-center" id="id7">
<span id="strain-te-fig"></span><a class="reference internal image-reference" href="_images/strain_te_dtu10mw.png"><img alt="_images/strain_te_dtu10mw.png" src="_images/strain_te_dtu10mw.png" style="height: 3in;" /></a>
<p class="caption"><span class="caption-text">Figure 7: Strain in trailing-edge panels</span></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Tutorial</a><ul>
<li><a class="reference internal" href="#rotor-aerodynamics">3.1. Rotor Aerodynamics</a></li>
<li><a class="reference internal" href="#rotor-aerodynamics-optimization">3.2. Rotor Aerodynamics Optimization</a></li>
<li><a class="reference internal" href="#rotor-aero-structures">3.3. Rotor Aero/Structures</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">2. Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="documentation.html"
                        title="next chapter">4. Documentation</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="documentation.html" title="4. Documentation"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="2. Installation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">RotorSE 0.1.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, NREL.
      Last updated on Apr 08, 2019.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>