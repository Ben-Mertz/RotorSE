
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>rotorse.rotor_geometry &#8212; RotorSE 0.1.0 documentation</title>
    <link rel="stylesheet" href="../../_static/nrel.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RotorSE 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for rotorse.rotor_geometry</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">StringIO</span> <span class="k">import</span> <span class="n">StringIO</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">commonse</span>

<span class="kn">from</span> <span class="nn">openmdao.api</span> <span class="k">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Group</span><span class="p">,</span> <span class="n">IndepVarComp</span>

<span class="kn">from</span> <span class="nn">akima</span> <span class="k">import</span> <span class="n">Akima</span><span class="p">,</span> <span class="n">akima_interp_with_derivs</span>
<span class="kn">from</span> <span class="nn">ccblade.ccblade_component</span> <span class="k">import</span> <span class="n">CCBladeGeometry</span>
<span class="kn">from</span> <span class="nn">ccblade</span> <span class="k">import</span> <span class="n">CCAirfoil</span>
<span class="kn">from</span> <span class="nn">airfoilprep</span> <span class="k">import</span> <span class="n">Airfoil</span>
<span class="kn">from</span> <span class="nn">precomp</span> <span class="k">import</span> <span class="n">Profile</span><span class="p">,</span> <span class="n">Orthotropic2DMaterial</span><span class="p">,</span> <span class="n">CompositeSection</span><span class="p">,</span> <span class="n">_precomp</span>

<span class="n">NINPUT</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">TURBULENCE_CLASS</span> <span class="o">=</span> <span class="n">commonse</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="s1">&#39;A B C&#39;</span><span class="p">)</span>
<span class="n">TURBINE_CLASS</span> <span class="o">=</span> <span class="n">commonse</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="s1">&#39;I II III&#39;</span><span class="p">)</span>
<span class="n">DRIVETRAIN_TYPE</span> <span class="o">=</span> <span class="n">commonse</span><span class="o">.</span><span class="n">enum</span><span class="o">.</span><span class="n">Enum</span><span class="p">(</span><span class="s1">&#39;geared single_stage multi_drive pm_direct_drive&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="ReferenceBlade"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.ReferenceBlade">[docs]</a><span class="k">class</span> <span class="nc">ReferenceBlade</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>           <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rating</span>         <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drivetrainType</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downwind</span>       <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nBlades</span>        <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">bladeLength</span>   <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hubFraction</span>   <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precone</span>       <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span>          <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span>         <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_in</span>      <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span>      <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precurve</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precurveT</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presweep</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airfoils</span>  <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_cylinder</span>     <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_max_chord</span>    <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spar_thickness</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_thickness</span>   <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">le_location</span>    <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">web1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web4</span> <span class="o">=</span> <span class="kc">None</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_spar</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_te</span>   <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vin</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vout</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_tsr</span>  <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_minOmega</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_maxOmega</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">setRin</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">r_cylinder</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_max_chord</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">NINPUT</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span>
        
    <span class="k">def</span> <span class="nf">getAeroPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_AFFiles&#39;</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">getStructPath</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_PreCompFiles&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">getAirfoilCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span><span class="p">:</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.dat&#39;</span><span class="p">,</span><span class="s1">&#39;.pfl&#39;</span><span class="p">),</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">set_polars</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">thickness</span><span class="p">,</span> <span class="n">af_thicknesses</span><span class="p">,</span> <span class="n">af_files</span><span class="p">):</span>
        <span class="n">af_ref</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="p">)</span>
        <span class="n">afinit</span> <span class="o">=</span> <span class="n">CCAirfoil</span><span class="o">.</span><span class="n">initFromAerodynFile</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">af_file</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">af_files</span><span class="p">):</span>
            <span class="n">af_ref</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">afinit</span><span class="p">(</span><span class="n">af_file</span><span class="p">)</span>
        <span class="c1"># Get common alpha</span>
        <span class="n">af_alpha</span> <span class="o">=</span> <span class="n">Airfoil</span><span class="o">.</span><span class="n">initFromAerodynFile</span><span class="p">(</span><span class="n">af_files</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">alpha</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">af_alpha</span><span class="o">.</span><span class="n">createDataGrid</span><span class="p">()</span>
        <span class="c1"># Blend airfoil polars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BlendAirfoils</span><span class="p">(</span><span class="n">af_ref</span><span class="p">,</span> <span class="n">af_thicknesses</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">thickness</span><span class="p">)</span>
            
    <span class="k">def</span> <span class="nf">BlendAirfoils</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">af_ref</span><span class="p">,</span> <span class="n">af_thicknesses</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">thickness</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">airfoils</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">thk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thickness</span><span class="p">):</span>
            <span class="c1"># Blend airfoils with exception handling</span>
            <span class="k">if</span> <span class="n">thk</span> <span class="ow">in</span> <span class="n">af_thicknesses</span><span class="p">:</span>
                <span class="n">af_out</span> <span class="o">=</span> <span class="n">af_ref</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="o">==</span><span class="n">thk</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># print thk, thk</span>
            <span class="k">elif</span> <span class="n">thk</span> <span class="o">&gt;</span> <span class="nb">max</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="p">):</span>
                <span class="n">af_out</span> <span class="o">=</span> <span class="n">af_ref</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="p">)]</span>
                <span class="c1"># print thk, af_thicknesses[np.argmax(af_thicknesses)]</span>
            <span class="k">elif</span> <span class="n">thk</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="p">):</span>
                <span class="n">af_out</span> <span class="o">=</span> <span class="n">af_ref</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">af_thicknesses</span><span class="p">)]</span>
                <span class="c1"># print thk, af_thicknesses[np.argmin(af_thicknesses)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Blend airfoils</span>
                <span class="n">af1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">af_thicknesses</span> <span class="o">&lt;</span> <span class="n">thk</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">af2</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">af_thicknesses</span> <span class="o">&gt;</span> <span class="n">thk</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">thk1</span> <span class="o">=</span> <span class="n">af_thicknesses</span><span class="p">[</span><span class="n">af1</span><span class="p">]</span>
                <span class="n">thk2</span> <span class="o">=</span> <span class="n">af_thicknesses</span><span class="p">[</span><span class="n">af2</span><span class="p">]</span>
                <span class="n">blend2</span> <span class="o">=</span> <span class="p">(</span><span class="n">thk</span><span class="o">-</span><span class="n">thk1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">thk2</span><span class="o">-</span><span class="n">thk1</span><span class="p">)</span>
                <span class="n">blend1</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">blend2</span>

                <span class="n">cl1</span><span class="p">,</span> <span class="n">cd1</span> <span class="o">=</span> <span class="n">af_ref</span><span class="p">[</span><span class="n">af1</span><span class="p">]</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="n">Re</span><span class="p">)</span>
                <span class="n">cl2</span><span class="p">,</span> <span class="n">cd2</span> <span class="o">=</span> <span class="n">af_ref</span><span class="p">[</span><span class="n">af2</span><span class="p">]</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">alpha</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">,</span> <span class="n">Re</span><span class="p">)</span>

                <span class="n">cl</span> <span class="o">=</span> <span class="n">cl1</span><span class="o">*</span><span class="n">blend1</span> <span class="o">+</span> <span class="n">cl2</span><span class="o">*</span><span class="n">blend2</span>
                <span class="n">cd</span> <span class="o">=</span> <span class="n">cd1</span><span class="o">*</span><span class="n">blend1</span> <span class="o">+</span> <span class="n">cd2</span><span class="o">*</span><span class="n">blend2</span>

                <span class="n">af_out</span> <span class="o">=</span> <span class="n">CCAirfoil</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">Re</span><span class="p">,</span> <span class="n">cl</span><span class="p">,</span> <span class="n">cd</span><span class="p">)</span>

                <span class="c1"># print &#39;%0.3f\t%d*%0.3f\t%d*%0.3f&#39;%(thk, thk1,blend1, thk2,blend2)</span>
                <span class="c1"># import matplotlib.pyplot as plt</span>
                <span class="c1"># plt.figure()</span>
                <span class="c1"># plt.plot(alpha, cl1, label=str(thk1))</span>
                <span class="c1"># plt.plot(alpha, cl2, label=str(thk2))</span>
                <span class="c1"># plt.plot(alpha, cl, label=str(thk))</span>
                <span class="c1"># plt.legend()</span>
                <span class="c1"># plt.show()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">airfoils</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">af_out</span></div>

        
<div class="viewcode-block" id="NREL5MW"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.NREL5MW">[docs]</a><span class="k">class</span> <span class="nc">NREL5MW</span><span class="p">(</span><span class="n">ReferenceBlade</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">NREL5MW</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># Raw data from https://www.nrel.gov/docs/fy09osti/38060.pdf</span>
        <span class="c1">#Node,RNodes,AeroTwst,DRNodes,Chord,Airfoil,Table</span>
        <span class="c1">#(-),(m),(deg),(m),(m),(-)</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span>
        <span class="sd">&quot;&quot;&quot;1,2.8667,13.308,2.7333,3.542,Cylinder1.dat</span>
<span class="sd">        2,5.6000,13.308,2.7333,3.854,Cylinder1.dat</span>
<span class="sd">        3,8.3333,13.308,2.7333,4.167,Cylinder2.dat</span>
<span class="sd">        4,11.7500,13.308,4.1000,4.557,DU40_A17.dat</span>
<span class="sd">        5,15.8500,11.480,4.1000,4.652,DU35_A17.dat</span>
<span class="sd">        6,19.9500,10.162,4.1000,4.458,DU35_A17.dat</span>
<span class="sd">        7,24.0500,9.011,4.1000,4.249,DU30_A17.dat</span>
<span class="sd">        8,28.1500,7.795,4.1000,4.007,DU25_A17.dat</span>
<span class="sd">        9,32.2500,6.544,4.1000,3.748,DU25_A17.dat</span>
<span class="sd">        10,36.3500,5.361,4.1000,3.502,DU21_A17.dat</span>
<span class="sd">        11,40.4500,4.188,4.1000,3.256,DU21_A17.dat</span>
<span class="sd">        12,44.5500,3.125,4.1000,3.010,NACA64_A17.dat</span>
<span class="sd">        13,48.6500,2.319,4.1000,2.764,NACA64_A17.dat</span>
<span class="sd">        14,52.7500,1.526,4.1000,2.518,NACA64_A17.dat</span>
<span class="sd">        15,56.1667,0.863,2.7333,2.313,NACA64_A17.dat</span>
<span class="sd">        16,58.9000,0.370,2.7333,2.086,NACA64_A17.dat</span>
<span class="sd">        17,61.6333,0.106,2.7333,1.419,NACA64_A17.dat&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># from Sandia 61.5m blade, Numad</span>
        <span class="n">raw_r_thick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0000000E+00</span><span class="p">,</span> <span class="mf">3.0000000E-01</span><span class="p">,</span> <span class="mf">4.0000000E-01</span><span class="p">,</span> <span class="mf">5.0000000E-01</span><span class="p">,</span> <span class="mf">6.0000000E-01</span><span class="p">,</span> <span class="mf">7.0000000E-01</span><span class="p">,</span> <span class="mf">8.0000000E-01</span><span class="p">,</span> <span class="mf">1.3667000E+00</span><span class="p">,</span> <span class="mf">1.5000000E+00</span><span class="p">,</span> <span class="mf">1.6000000E+00</span><span class="p">,</span> <span class="mf">4.1000000E+00</span><span class="p">,</span> <span class="mf">5.5000000E+00</span><span class="p">,</span> <span class="mf">6.8333000E+00</span><span class="p">,</span> <span class="mf">9.0000000E+00</span><span class="p">,</span> <span class="mf">1.0250000E+01</span><span class="p">,</span> <span class="mf">1.2000000E+01</span><span class="p">,</span> <span class="mf">1.4350000E+01</span><span class="p">,</span> <span class="mf">1.7000000E+01</span><span class="p">,</span> <span class="mf">1.8450000E+01</span><span class="p">,</span> <span class="mf">2.0500000E+01</span><span class="p">,</span> <span class="mf">2.2550000E+01</span><span class="p">,</span> <span class="mf">2.4600000E+01</span><span class="p">,</span> <span class="mf">2.6650000E+01</span><span class="p">,</span> <span class="mf">3.0750000E+01</span><span class="p">,</span> <span class="mf">3.2000000E+01</span><span class="p">,</span> <span class="mf">3.4850000E+01</span><span class="p">,</span> <span class="mf">3.7000000E+01</span><span class="p">,</span> <span class="mf">3.8950000E+01</span><span class="p">,</span> <span class="mf">4.1000000E+01</span><span class="p">,</span> <span class="mf">4.2000000E+01</span><span class="p">,</span> <span class="mf">4.3050000E+01</span><span class="p">,</span> <span class="mf">4.5000000E+01</span><span class="p">,</span> <span class="mf">4.7150000E+01</span><span class="p">,</span> <span class="mf">5.1250000E+01</span><span class="p">,</span> <span class="mf">5.4666700E+01</span><span class="p">,</span> <span class="mf">5.7400000E+01</span><span class="p">,</span> <span class="mf">6.0133300E+01</span><span class="p">,</span> <span class="mf">6.1500000E+01</span><span class="p">])</span>
        <span class="n">raw_r_thick</span> <span class="o">=</span> <span class="n">raw_r_thick</span><span class="o">/</span><span class="n">raw_r_thick</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">raw_thick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">1.0000000E+00</span><span class="p">,</span> <span class="mf">9.8751500E-01</span><span class="p">,</span> <span class="mf">9.7816802E-01</span><span class="p">,</span> <span class="mf">7.5439880E-01</span><span class="p">,</span> <span class="mf">6.4303911E-01</span><span class="p">,</span> <span class="mf">5.5121360E-01</span><span class="p">,</span> <span class="mf">4.4117964E-01</span><span class="p">,</span> <span class="mf">4.0500000E-01</span><span class="p">,</span> <span class="mf">3.7480511E-01</span><span class="p">,</span> <span class="mf">3.5000000E-01</span><span class="p">,</span> <span class="mf">3.3433084E-01</span><span class="p">,</span> <span class="mf">3.2616543E-01</span><span class="p">,</span> <span class="mf">3.1401675E-01</span><span class="p">,</span> <span class="mf">3.0000000E-01</span><span class="p">,</span> <span class="mf">2.8244827E-01</span><span class="p">,</span> <span class="mf">2.6403824E-01</span><span class="p">,</span> <span class="mf">2.3997369E-01</span><span class="p">,</span> <span class="mf">2.3391742E-01</span><span class="p">,</span> <span class="mf">2.2014585E-01</span><span class="p">,</span> <span class="mf">2.0967308E-01</span><span class="p">,</span> <span class="mf">2.0011990E-01</span><span class="p">,</span> <span class="mf">1.9007578E-01</span><span class="p">,</span> <span class="mf">1.8516665E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">,</span> <span class="mf">1.8000000E-01</span><span class="p">])</span>
        
        <span class="c1"># Name to recover / lookup this info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>     <span class="o">=</span> <span class="s1">&#39;5MW&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rating</span>   <span class="o">=</span> <span class="mf">5e6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nBlades</span>  <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downwind</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">=</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drivetrain</span>    <span class="o">=</span> <span class="n">DRIVETRAIN_TYPE</span><span class="p">[</span><span class="s1">&#39;GEARED&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hub_height</span>  <span class="o">=</span> <span class="mf">90.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hubFraction</span> <span class="o">=</span> <span class="mf">0.025</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">bladeLength</span> <span class="o">=</span> <span class="mf">61.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precone</span>     <span class="o">=</span> <span class="mf">2.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span>        <span class="o">=</span> <span class="mf">5.0</span>
        
        <span class="c1"># Analysis grid (old r_str)</span>
        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">eps</span><span class="p">,</span> <span class="mf">0.00492790457512</span><span class="p">,</span> <span class="mf">0.00652942887106</span><span class="p">,</span> <span class="mf">0.00813095316699</span><span class="p">,</span>
                           <span class="mf">0.00983257273154</span><span class="p">,</span> <span class="mf">0.0114340970275</span><span class="p">,</span> <span class="mf">0.0130356213234</span><span class="p">,</span> <span class="mf">0.02222276</span><span class="p">,</span>
                           <span class="mf">0.024446481932</span><span class="p">,</span> <span class="mf">0.026048006228</span><span class="p">,</span> <span class="mf">0.06666667</span><span class="p">,</span> <span class="mf">0.089508406455</span><span class="p">,</span>
                           <span class="mf">0.11111057</span><span class="p">,</span> <span class="mf">0.146462614229</span><span class="p">,</span> <span class="mf">0.16666667</span><span class="p">,</span> <span class="mf">0.195309105255</span><span class="p">,</span> <span class="mf">0.23333333</span><span class="p">,</span>
                           <span class="mf">0.276686558545</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.333640766319</span><span class="p">,</span> <span class="mf">0.36666667</span><span class="p">,</span> <span class="mf">0.400404310407</span><span class="p">,</span>
                           <span class="mf">0.43333333</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.520818918408</span><span class="p">,</span> <span class="mf">0.56666667</span><span class="p">,</span> <span class="mf">0.602196371696</span><span class="p">,</span>
                           <span class="mf">0.63333333</span><span class="p">,</span> <span class="mf">0.667358391486</span><span class="p">,</span> <span class="mf">0.683573824984</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.73242031601</span><span class="p">,</span>
                           <span class="mf">0.76666667</span><span class="p">,</span> <span class="mf">0.83333333</span><span class="p">,</span> <span class="mf">0.88888943</span><span class="p">,</span> <span class="mf">0.93333333</span><span class="p">,</span> <span class="mf">0.97777724</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">eps</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">size</span>
        
        <span class="c1"># Blade aero geometry</span>
        <span class="n">raw</span>    <span class="o">=</span> <span class="nb">list</span><span class="p">([</span><span class="n">row</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">raw</span><span class="p">)])</span>
        <span class="n">raw_r</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">])</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">raw</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">raw_tw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">])</span>
        <span class="n">raw_c</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">])</span>
        <span class="n">raw_af</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">raw</span><span class="p">]</span>

        <span class="n">idx_cylinder</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">raw_r</span> <span class="o">-</span> <span class="mf">11.75</span><span class="o">/</span><span class="mf">61.6333</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_cylinder</span>  <span class="o">=</span> <span class="n">raw_r</span><span class="p">[</span><span class="n">idx_cylinder</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_max_chord</span> <span class="o">=</span> <span class="n">raw_r</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_c</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRin</span><span class="p">()</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_tw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span>     <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord_ref</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
        <span class="c1">#np.array([3.2612, 3.3100915356, 3.32587052924, 3.34159388653, 3.35823798667, 3.37384375335,</span>
        <span class="c1">#3.38939112914, 3.4774055542, 3.49839685, 3.51343645709, 3.87017220335, 4.04645623801, 4.19408216643,</span>
        <span class="c1">#                               4.47641008477, 4.55844487985, 4.57383098262, 4.57285771934, 4.51914315648, 4.47677655262, 4.40075650022,</span>
        <span class="c1">#                               4.31069949379, 4.20483735936, 4.08985563932, 3.82931757126, 3.74220276467, 3.54415796922, 3.38732428502,</span>
        <span class="c1">#                               3.24931446473, 3.23421422609, 3.22701537997, 3.21972125648, 3.08979310611, 2.95152261813, 2.330753331,</span>
        <span class="c1">#                               2.05553464181, 1.82577817774, 1.5860853279, 1.4621])</span>
        <span class="c1"># TODO: what&#39;s the difference?</span>
        <span class="c1">#print np.c_[self.chord_ref, chord]</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">precurve</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precurveT</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presweep</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">chord</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        <span class="c1"># Spar cap thickness- linear taper from end of cylinder to tip</span>
        <span class="n">spar_str_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.04974449</span><span class="p">,</span> <span class="mf">0.04973077</span><span class="p">,</span> <span class="mf">0.04971704</span><span class="p">,</span> <span class="mf">0.04970245</span><span class="p">,</span> <span class="mf">0.04968871</span><span class="p">,</span>
                                  <span class="mf">0.04967496</span><span class="p">,</span> <span class="mf">0.04959602</span><span class="p">,</span> <span class="mf">0.04957689</span><span class="p">,</span> <span class="mf">0.04956310</span><span class="p">,</span> <span class="mf">0.04921172</span><span class="p">,</span> <span class="mf">0.04901266</span><span class="p">,</span>
                                  <span class="mf">0.04882344</span><span class="p">,</span> <span class="mf">0.04851176</span><span class="p">,</span> <span class="mf">0.04833251</span><span class="p">,</span> <span class="mf">0.04807698</span><span class="p">,</span> <span class="mf">0.04773559</span><span class="p">,</span> <span class="mf">0.04749433</span><span class="p">,</span>
                                  <span class="mf">0.04743920</span><span class="p">,</span> <span class="mf">0.04738432</span><span class="p">,</span> <span class="mf">0.04728946</span><span class="p">,</span> <span class="mf">0.04707145</span><span class="p">,</span> <span class="mf">0.04666403</span><span class="p">,</span> <span class="mf">0.04495385</span><span class="p">,</span>
                                  <span class="mf">0.04418236</span><span class="p">,</span> <span class="mf">0.04219110</span><span class="p">,</span> <span class="mf">0.04038254</span><span class="p">,</span> <span class="mf">0.03861577</span><span class="p">,</span> <span class="mf">0.03649927</span><span class="p">,</span> <span class="mf">0.03542479</span><span class="p">,</span>
                                  <span class="mf">0.03429437</span><span class="p">,</span> <span class="mf">0.03194315</span><span class="p">,</span> <span class="mf">0.02928793</span><span class="p">,</span> <span class="mf">0.02357558</span><span class="p">,</span> <span class="mf">0.01826438</span><span class="p">,</span> <span class="mf">0.01365496</span><span class="p">,</span>
                                  <span class="mf">0.00872504</span><span class="p">,</span> <span class="mf">0.0061398</span><span class="p">])</span>
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">spar_str_orig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spar_thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        
        <span class="n">te_str_orig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.10082163</span><span class="p">,</span> <span class="mf">0.10085572</span><span class="p">,</span> <span class="mf">0.10088880</span><span class="p">,</span> <span class="mf">0.10092286</span><span class="p">,</span> <span class="mf">0.10095388</span><span class="p">,</span>
                                <span class="mf">0.10098389</span><span class="p">,</span> <span class="mf">0.10113668</span><span class="p">,</span> <span class="mf">0.10116870</span><span class="p">,</span> <span class="mf">0.10119056</span><span class="p">,</span> <span class="mf">0.10140956</span><span class="p">,</span> <span class="mf">0.10124916</span><span class="p">,</span>
                                <span class="mf">0.10090965</span><span class="p">,</span> <span class="mf">0.09996015</span><span class="p">,</span> <span class="mf">0.09919790</span><span class="p">,</span> <span class="mf">0.09784357</span><span class="p">,</span> <span class="mf">0.09554915</span><span class="p">,</span> <span class="mf">0.09204126</span><span class="p">,</span>
                                <span class="mf">0.08974946</span><span class="p">,</span> <span class="mf">0.08603226</span><span class="p">,</span> <span class="mf">0.08200398</span><span class="p">,</span> <span class="mf">0.07760656</span><span class="p">,</span> <span class="mf">0.07314138</span><span class="p">,</span> <span class="mf">0.06393682</span><span class="p">,</span>
                                <span class="mf">0.06083395</span><span class="p">,</span> <span class="mf">0.05341039</span><span class="p">,</span> <span class="mf">0.04736243</span><span class="p">,</span> <span class="mf">0.04205857</span><span class="p">,</span> <span class="mf">0.03645787</span><span class="p">,</span> <span class="mf">0.03391951</span><span class="p">,</span>
                                <span class="mf">0.03146610</span><span class="p">,</span> <span class="mf">0.02706400</span><span class="p">,</span> <span class="mf">0.02308701</span><span class="p">,</span> <span class="mf">0.01642426</span><span class="p">,</span> <span class="mf">0.01190607</span><span class="p">,</span> <span class="mf">0.00896844</span><span class="p">,</span>
                                <span class="mf">0.00663243</span><span class="p">,</span> <span class="mf">0.00569</span><span class="p">])</span>
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">te_str_orig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">le_location</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.498</span><span class="p">,</span> <span class="mf">0.497</span><span class="p">,</span> <span class="mf">0.465</span><span class="p">,</span> <span class="mf">0.447</span><span class="p">,</span> <span class="mf">0.43</span><span class="p">,</span> <span class="mf">0.411</span><span class="p">,</span>
                                     <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span>
                                     <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>


        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r_thick</span><span class="p">,</span> <span class="n">raw_thick</span><span class="p">)</span>
        <span class="n">thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
         
        <span class="c1"># Load airfoil polar files</span>
        <span class="n">afpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAeroPath</span><span class="p">()</span>
        <span class="n">af_thicknesses</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">18.</span><span class="p">,</span> <span class="mf">21.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">35.</span><span class="p">,</span> <span class="mf">40.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">])</span>
        <span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NACA64_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;DU21_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;DU25_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;DU30_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;DU35_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;DU40_A17.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;Cylinder1.dat&#39;</span><span class="p">]</span>
        <span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afpath</span><span class="p">,</span> <span class="n">af_file</span><span class="p">)</span> <span class="k">for</span> <span class="n">af_file</span> <span class="ow">in</span> <span class="n">airfoil_files</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_polars</span><span class="p">(</span><span class="n">thickness</span><span class="p">,</span> <span class="n">af_thicknesses</span><span class="p">,</span> <span class="n">airfoil_files</span><span class="p">)</span>

        <span class="c1"># Now set best guess at airfoil cordinates along span without interpolating like the polar (this is just for plotting)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">):</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">raw_r</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">[</span><span class="n">k</span><span class="p">])</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afpath</span><span class="p">,</span> <span class="n">raw_af</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

        <span class="c1"># Layup info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_spar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">web1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">0.4114</span><span class="p">,</span> <span class="mf">0.4102</span><span class="p">,</span> <span class="mf">0.4094</span><span class="p">,</span> <span class="mf">0.3876</span><span class="p">,</span>
                              <span class="mf">0.3755</span><span class="p">,</span> <span class="mf">0.3639</span><span class="p">,</span> <span class="mf">0.345</span><span class="p">,</span> <span class="mf">0.3342</span><span class="p">,</span> <span class="mf">0.3313</span><span class="p">,</span> <span class="mf">0.3274</span><span class="p">,</span> <span class="mf">0.323</span><span class="p">,</span> <span class="mf">0.3206</span><span class="p">,</span> <span class="mf">0.3172</span><span class="p">,</span> <span class="mf">0.3138</span><span class="p">,</span> <span class="mf">0.3104</span><span class="p">,</span>
                              <span class="mf">0.307</span><span class="p">,</span> <span class="mf">0.3003</span><span class="p">,</span> <span class="mf">0.2982</span><span class="p">,</span> <span class="mf">0.2935</span><span class="p">,</span> <span class="mf">0.2899</span><span class="p">,</span> <span class="mf">0.2867</span><span class="p">,</span> <span class="mf">0.2833</span><span class="p">,</span> <span class="mf">0.2817</span><span class="p">,</span> <span class="mf">0.2799</span><span class="p">,</span> <span class="mf">0.2767</span><span class="p">,</span> <span class="mf">0.2731</span><span class="p">,</span>
                              <span class="mf">0.2664</span><span class="p">,</span> <span class="mf">0.2607</span><span class="p">,</span> <span class="mf">0.2562</span><span class="p">,</span> <span class="mf">0.1886</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">0.5886</span><span class="p">,</span> <span class="mf">0.5868</span><span class="p">,</span> <span class="mf">0.5854</span><span class="p">,</span> <span class="mf">0.5508</span><span class="p">,</span>
                              <span class="mf">0.5315</span><span class="p">,</span> <span class="mf">0.5131</span><span class="p">,</span> <span class="mf">0.4831</span><span class="p">,</span> <span class="mf">0.4658</span><span class="p">,</span> <span class="mf">0.4687</span><span class="p">,</span> <span class="mf">0.4726</span><span class="p">,</span> <span class="mf">0.477</span><span class="p">,</span> <span class="mf">0.4794</span><span class="p">,</span> <span class="mf">0.4828</span><span class="p">,</span> <span class="mf">0.4862</span><span class="p">,</span> <span class="mf">0.4896</span><span class="p">,</span>
                              <span class="mf">0.493</span><span class="p">,</span> <span class="mf">0.4997</span><span class="p">,</span> <span class="mf">0.5018</span><span class="p">,</span> <span class="mf">0.5065</span><span class="p">,</span> <span class="mf">0.5101</span><span class="p">,</span> <span class="mf">0.5133</span><span class="p">,</span> <span class="mf">0.5167</span><span class="p">,</span> <span class="mf">0.5183</span><span class="p">,</span> <span class="mf">0.5201</span><span class="p">,</span> <span class="mf">0.5233</span><span class="p">,</span> <span class="mf">0.5269</span><span class="p">,</span>
                              <span class="mf">0.5336</span><span class="p">,</span> <span class="mf">0.5393</span><span class="p">,</span> <span class="mf">0.5438</span><span class="p">,</span> <span class="mf">0.6114</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span>
                              <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
                              <span class="mf">1.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">web3</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

        
        <span class="c1"># Control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vin</span>      <span class="o">=</span> <span class="mf">3.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vout</span>     <span class="o">=</span> <span class="mf">25.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_minOmega</span> <span class="o">=</span> <span class="mf">6.9</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_maxOmega</span> <span class="o">=</span> <span class="mf">12.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_tsr</span>      <span class="o">=</span> <span class="mf">80.0</span> <span class="o">/</span> <span class="mf">11.4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_pitch</span>    <span class="o">=</span> <span class="mf">0.0</span></div>
        
        
<div class="viewcode-block" id="DTU10MW"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.DTU10MW">[docs]</a><span class="k">class</span> <span class="nc">DTU10MW</span><span class="p">(</span><span class="n">ReferenceBlade</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">DTU10MW</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span>   <span class="o">=</span> <span class="s1">&#39;10MW&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rating</span> <span class="o">=</span> <span class="mf">10e6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nBlades</span>  <span class="o">=</span> <span class="mi">3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">downwind</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">=</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">drivetrain</span>    <span class="o">=</span> <span class="n">DRIVETRAIN_TYPE</span><span class="p">[</span><span class="s1">&#39;GEARED&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">hub_height</span>  <span class="o">=</span> <span class="mf">119.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bladeLength</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mf">198.0</span> <span class="o">-</span> <span class="mf">4.6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hubFraction</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="mf">4.6</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bladeLength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precone</span>     <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tilt</span>        <span class="o">=</span> <span class="mf">6.0</span>

        <span class="c1"># DTU 10MW BLADE PROPS</span>
        <span class="c1">#Eta,Chord,Twist,Rel.Thick.,Abs.Thick.,PreBend,Sweep,PitchAx.</span>
        <span class="c1">#[-],[mm],[deg],[%],[mm],[mm],[mm],[%]</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;0.0000,4600.000,14.500,100.000,4.600,-0.000,0.000,0.500</span>
<span class="s2">        0.0176,4601.556,14.037,99.739,4.590,-7.669,0.000,0.500</span>
<span class="s2">        0.0313,4601.651,13.737,98.192,4.518,-14.693,0.000,0.500</span>
<span class="s2">        0.0420,4609.049,13.545,95.682,4.410,-20.900,0.000,0.498</span>
<span class="s2">        0.0507,4636.155,13.413,92.513,4.289,-26.516,0.000,0.489</span>
<span class="s2">        0.0579,4667.782,13.312,89.240,4.166,-31.484,0.000,0.480</span>
<span class="s2">        0.0642,4698.278,13.223,86.130,4.047,-35.920,0.000,0.473</span>
<span class="s2">        0.0700,4729.304,13.139,83.061,3.928,-40.113,0.000,0.465</span>
<span class="s2">        0.0758,4763.632,13.056,79.871,3.805,-44.343,0.000,0.459</span>
<span class="s2">        0.0821,4807.427,12.969,76.338,3.670,-48.998,0.000,0.453</span>
<span class="s2">        0.0893,4869.795,12.874,72.208,3.516,-54.497,0.000,0.445</span>
<span class="s2">        0.0980,4953.764,12.752,67.393,3.338,-61.250,0.000,0.435</span>
<span class="s2">        0.1087,5063.527,12.565,61.870,3.133,-69.747,0.000,0.423</span>
<span class="s2">        0.1224,5218.259,12.223,55.573,2.900,-80.713,0.000,0.408</span>
<span class="s2">        0.1400,5444.001,11.600,48.640,2.648,-95.183,0.000,0.389</span>
<span class="s2">        0.1610,5688.237,10.674,42.379,2.411,-112.440,0.000,0.369</span>
<span class="s2">        0.1841,5937.831,9.329,37.456,2.224,-131.381,0.000,0.351</span>
<span class="s2">        0.2093,5987.655,7.980,34.759,2.081,-152.316,0.000,0.339</span>
<span class="s2">        0.2366,5990.629,6.724,33.223,1.990,-175.303,0.000,0.331</span>
<span class="s2">        0.2660,5896.920,5.879,32.682,1.927,-200.154,0.000,0.331</span>
<span class="s2">        0.2973,5704.650,5.222,32.580,1.859,-227.286,0.000,0.332</span>
<span class="s2">        0.3305,5463.845,4.668,32.606,1.782,-257.214,0.000,0.341</span>
<span class="s2">        0.3653,5176.618,4.131,32.547,1.685,-292.010,0.000,0.353</span>
<span class="s2">        0.4015,4857.565,3.614,32.367,1.572,-334.013,0.000,0.368</span>
<span class="s2">        0.4387,4520.899,3.085,32.063,1.450,-385.250,0.000,0.387</span>
<span class="s2">        0.4766,4179.799,2.496,31.474,1.316,-447.911,0.000,0.407</span>
<span class="s2">        0.5148,3842.977,1.843,30.700,1.180,-526.833,0.000,0.427</span>
<span class="s2">        0.5529,3519.719,1.161,29.781,1.048,-625.007,0.000,0.447</span>
<span class="s2">        0.5905,3217.849,0.472,28.768,0.926,-744.099,0.000,0.465</span>
<span class="s2">        0.6273,2942.296,-0.197,27.680,0.814,-887.576,0.000,0.481</span>
<span class="s2">        0.6628,2695.475,-0.821,26.556,0.716,-1057.588,0.000,0.495</span>
<span class="s2">        0.6969,2477.568,-1.382,25.426,0.630,-1253.153,0.000,0.506</span>
<span class="s2">        0.7293,2287.113,-1.870,24.340,0.557,-1474.395,0.000,0.515</span>
<span class="s2">        0.7597,2122.247,-2.277,23.397,0.497,-1720.593,0.000,0.522</span>
<span class="s2">        0.7882,1980.577,-2.603,22.828,0.452,-1987.436,0.000,0.525</span>
<span class="s2">        0.8145,1859.108,-2.850,22.755,0.423,-2273.422,0.000,0.526</span>
<span class="s2">        0.8387,1754.739,-3.024,22.673,0.398,-2573.827,0.000,0.526</span>
<span class="s2">        0.8608,1665.081,-3.125,22.533,0.375,-2884.584,0.000,0.523</span>
<span class="s2">        0.8809,1586.370,-3.160,22.351,0.355,-3202.247,0.000,0.519</span>
<span class="s2">        0.8990,1511.990,-3.130,22.145,0.335,-3522.496,0.000,0.513</span>
<span class="s2">        0.9153,1434.483,-3.038,21.930,0.315,-3841.371,0.000,0.507</span>
<span class="s2">        0.9299,1350.941,-2.883,21.722,0.293,-4154.921,0.000,0.499</span>
<span class="s2">        0.9429,1260.917,-2.669,21.533,0.272,-4460.302,0.000,0.492</span>
<span class="s2">        0.9544,1166.025,-2.399,21.372,0.249,-4755.279,0.000,0.485</span>
<span class="s2">        0.9646,1062.491,-2.085,21.241,0.226,-5037.057,0.000,0.477</span>
<span class="s2">        0.9736,957.120,-1.727,21.143,0.202,-5304.189,0.000,0.470</span>
<span class="s2">        0.9816,862.535,-1.340,21.073,0.182,-5555.265,0.000,0.464</span>
<span class="s2">        0.9885,759.755,-0.927,21.030,0.160,-5789.509,0.000,0.457</span>
<span class="s2">        0.9946,540.567,-0.483,21.007,0.114,-6006.941,0.000,0.452</span>
<span class="s2">        1.0000,96.200,-0.037,21.000,0.020,-6206.217,0.000,0.446&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="n">eps</span> <span class="o">=</span> <span class="mf">1e-4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">eps</span><span class="p">,</span> <span class="mf">0.0204081632653</span><span class="p">,</span> <span class="mf">0.0408163265306</span><span class="p">,</span> <span class="mf">0.0612244897959</span><span class="p">,</span> <span class="mf">0.0816326530612</span><span class="p">,</span> <span class="mf">0.102040816327</span><span class="p">,</span>
                           <span class="mf">0.122448979592</span><span class="p">,</span> <span class="mf">0.142857142857</span><span class="p">,</span> <span class="mf">0.163265306122</span><span class="p">,</span> <span class="mf">0.183673469388</span><span class="p">,</span> <span class="mf">0.204081632653</span><span class="p">,</span> <span class="mf">0.224489795918</span><span class="p">,</span>
                           <span class="mf">0.244897959184</span><span class="p">,</span> <span class="mf">0.265306122449</span><span class="p">,</span> <span class="mf">0.285714285714</span><span class="p">,</span> <span class="mf">0.30612244898</span><span class="p">,</span> <span class="mf">0.326530612245</span><span class="p">,</span> <span class="mf">0.34693877551</span><span class="p">,</span>
                           <span class="mf">0.367346938776</span><span class="p">,</span> <span class="mf">0.387755102041</span><span class="p">,</span> <span class="mf">0.408163265306</span><span class="p">,</span> <span class="mf">0.428571428571</span><span class="p">,</span> <span class="mf">0.448979591837</span><span class="p">,</span> <span class="mf">0.469387755102</span><span class="p">,</span>
                           <span class="mf">0.489795918367</span><span class="p">,</span> <span class="mf">0.510204081633</span><span class="p">,</span> <span class="mf">0.530612244898</span><span class="p">,</span> <span class="mf">0.551020408163</span><span class="p">,</span> <span class="mf">0.571428571429</span><span class="p">,</span> <span class="mf">0.591836734694</span><span class="p">,</span>
                           <span class="mf">0.612244897959</span><span class="p">,</span> <span class="mf">0.632653061224</span><span class="p">,</span> <span class="mf">0.65306122449</span><span class="p">,</span> <span class="mf">0.673469387755</span><span class="p">,</span> <span class="mf">0.69387755102</span><span class="p">,</span> <span class="mf">0.714285714286</span><span class="p">,</span>
                           <span class="mf">0.734693877551</span><span class="p">,</span> <span class="mf">0.755102040816</span><span class="p">,</span> <span class="mf">0.775510204082</span><span class="p">,</span> <span class="mf">0.795918367347</span><span class="p">,</span> <span class="mf">0.816326530612</span><span class="p">,</span> <span class="mf">0.836734693878</span><span class="p">,</span>
                           <span class="mf">0.857142857143</span><span class="p">,</span> <span class="mf">0.877551020408</span><span class="p">,</span> <span class="mf">0.897959183673</span><span class="p">,</span> <span class="mf">0.918367346939</span><span class="p">,</span> <span class="mf">0.938775510204</span><span class="p">,</span> <span class="mf">0.959183673469</span><span class="p">,</span>
                           <span class="mf">0.979591836735</span><span class="p">,</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">eps</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">npts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="o">.</span><span class="n">size</span>
        
        <span class="n">raw</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">raw_r</span>   <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">raw_c</span>   <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-3</span>
        <span class="n">raw_tw</span>  <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">raw_th</span>  <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">raw_pre</span> <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">5</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-3</span>
        <span class="n">raw_sw</span>  <span class="o">=</span> <span class="n">raw</span><span class="p">[:,</span><span class="mi">6</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e-3</span>

        <span class="n">idx_cylinder</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_cylinder</span>  <span class="o">=</span> <span class="n">raw_r</span><span class="p">[</span><span class="n">idx_cylinder</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">r_max_chord</span> <span class="o">=</span> <span class="n">raw_r</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">raw_c</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRin</span><span class="p">()</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_tw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">theta</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span>     <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chord_ref</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
        <span class="c1">#self.chord_ref = np.array([5.38, 5.3800643553, 5.38031711143, 5.38780280252, 5.40677951126, 5.48505840079, 5.59326574185,</span>
        <span class="c1">#                               5.73141566075, 5.86843135503, 5.99999190341, 6.09904231251, 6.17116486928, 6.19400935481,</span>
        <span class="c1">#                               6.20302411962, 6.18309136227, 6.14171800022, 6.07759639166, 5.99796748755, 5.90179584286,</span>
        <span class="c1">#                               5.79486385463, 5.67757358533, 5.55267710905, 5.42166648998, 5.28499407124, 5.14373698212,</span>
        <span class="c1">#                               4.99871795233, 4.85053210974, 4.70010140244, 4.54830998864, 4.39588552607, 4.24360835244,</span>
        <span class="c1">#                               4.09216987991, 3.94187021346, 3.79298624168, 3.64578973915, 3.50055778142, 3.3575837574,</span>
        <span class="c1">#                               3.21717725827, 3.07962549378, 2.94515242311, 2.81389912887, 2.68570603823, 2.56087639104,</span>
        <span class="c1">#                               2.43927605964, 2.31610551275, 2.18016451487, 2.01720583646, 1.81389861412, 1.50584435653, 0.6])</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_pre</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precurve</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">precurveT</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_sw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">presweep</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>

        <span class="c1"># # Spar cap thickness- linear taper from end of cylinder to tip</span>
        <span class="c1"># self.spar_thickness = np.linspace(1.44, 0.53, NINPUT)</span>
        <span class="c1"># self.te_thickness   = np.linspace(0.8, 0.2, NINPUT)</span>
        <span class="n">t_spar</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0320004189281497</span><span class="p">,</span> <span class="mf">0.032413233514380135</span><span class="p">,</span> <span class="mf">0.0347998074739571</span><span class="p">,</span> <span class="mf">0.039211725978893365</span><span class="p">,</span> <span class="mf">0.04448607137027535</span><span class="p">,</span> <span class="mf">0.05004958035967985</span><span class="p">,</span> 
                  <span class="mf">0.055773198307797055</span><span class="p">,</span> <span class="mf">0.060808909220920346</span><span class="p">,</span> <span class="mf">0.06489796815102368</span><span class="p">,</span> <span class="mf">0.06729338026826848</span><span class="p">,</span> <span class="mf">0.07038507637861223</span><span class="p">,</span> <span class="mf">0.07320149826122159</span><span class="p">,</span> 
                  <span class="mf">0.07505402214311759</span><span class="p">,</span> <span class="mf">0.07709642418372635</span><span class="p">,</span> <span class="mf">0.07918050884914904</span><span class="p">,</span> <span class="mf">0.08103357158490876</span><span class="p">,</span> <span class="mf">0.08270252680667647</span><span class="p">,</span> <span class="mf">0.08403234987866959</span><span class="p">,</span> 
                  <span class="mf">0.08515644449040799</span><span class="p">,</span> <span class="mf">0.08607979218517818</span><span class="p">,</span> <span class="mf">0.08658210941996525</span><span class="p">,</span> <span class="mf">0.08659983499339703</span><span class="p">,</span> <span class="mf">0.08646447909743751</span><span class="p">,</span> <span class="mf">0.08581626920407662</span><span class="p">,</span> 
                  <span class="mf">0.0848164285567969</span><span class="p">,</span> <span class="mf">0.08377910964381965</span><span class="p">,</span> <span class="mf">0.0822367983198804</span><span class="p">,</span> <span class="mf">0.08070965621865138</span><span class="p">,</span> <span class="mf">0.07903672500724102</span><span class="p">,</span> <span class="mf">0.07736379667849971</span><span class="p">,</span> 
                  <span class="mf">0.07580112855098903</span><span class="p">,</span> <span class="mf">0.07416991429397488</span><span class="p">,</span> <span class="mf">0.07206050597089943</span><span class="p">,</span> <span class="mf">0.06946315980483178</span><span class="p">,</span> <span class="mf">0.0662730627859155</span><span class="p">,</span> <span class="mf">0.06268615362703936</span><span class="p">,</span> 
                  <span class="mf">0.058682210134965856</span><span class="p">,</span> <span class="mf">0.054168752160222426</span><span class="p">,</span> <span class="mf">0.049167791007208306</span><span class="p">,</span> <span class="mf">0.044039704321394174</span><span class="p">,</span> <span class="mf">0.0385981511713949</span><span class="p">,</span> <span class="mf">0.03302340214440563</span><span class="p">,</span> 
                  <span class="mf">0.027470859650715124</span><span class="p">,</span> <span class="mf">0.02200899556289725</span><span class="p">,</span> <span class="mf">0.016845764341483292</span><span class="p">,</span> <span class="mf">0.012236276175915984</span><span class="p">,</span> <span class="mf">0.008142142767238786</span><span class="p">,</span> <span class="mf">0.0047736891784759755</span><span class="p">,</span> 
                  <span class="mf">0.0035326892184044827</span><span class="p">,</span> <span class="mf">0.011810323720413905</span><span class="p">]</span> <span class="c1"># baseline spar cap and TE thickness for DTU10MW, from rotor_structure.ResizeCompositeSection - UPDATE when new composite layups are available</span>
        <span class="n">t_te</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.04200054984319648</span><span class="p">,</span> <span class="mf">0.04225117651974834</span><span class="p">,</span> <span class="mf">0.0449028267651131</span><span class="p">,</span> <span class="mf">0.05115482875366182</span><span class="p">,</span> <span class="mf">0.05773200373093057</span><span class="p">,</span> <span class="mf">0.0646076843283427</span><span class="p">,</span> 
                <span class="mf">0.07157444156721758</span><span class="p">,</span> <span class="mf">0.07838332015647545</span><span class="p">,</span> <span class="mf">0.08236702099771726</span><span class="p">,</span> <span class="mf">0.08636183420245723</span><span class="p">,</span> <span class="mf">0.08807738710796026</span><span class="p">,</span> <span class="mf">0.08841695885692735</span><span class="p">,</span> 
                <span class="mf">0.08435661818895519</span><span class="p">,</span> <span class="mf">0.08227717500375323</span><span class="p">,</span> <span class="mf">0.07523246366708176</span><span class="p">,</span> <span class="mf">0.0718785818529033</span><span class="p">,</span> <span class="mf">0.06482470192539755</span><span class="p">,</span> <span class="mf">0.061452305196879796</span><span class="p">,</span> 
                <span class="mf">0.054373783400364466</span><span class="p">,</span> <span class="mf">0.049840546332820826</span><span class="p">,</span> <span class="mf">0.043967287094035856</span><span class="p">,</span> <span class="mf">0.04027996631594854</span><span class="p">,</span> <span class="mf">0.034731762503613456</span><span class="p">,</span> <span class="mf">0.03165893729347588</span><span class="p">,</span> 
                <span class="mf">0.028640564155395527</span><span class="p">,</span> <span class="mf">0.026206171585164948</span><span class="p">,</span> <span class="mf">0.022504329520350853</span><span class="p">,</span> <span class="mf">0.01841167062556291</span><span class="p">,</span> <span class="mf">0.01663921489751576</span><span class="p">,</span> <span class="mf">0.01573381774722061</span><span class="p">,</span> 
                <span class="mf">0.010781562015476103</span><span class="p">,</span> <span class="mf">0.010435507532911352</span><span class="p">,</span> <span class="mf">0.009993455758864546</span><span class="p">,</span> <span class="mf">0.009677378170431624</span><span class="p">,</span> <span class="mf">0.009324302005793973</span><span class="p">,</span> <span class="mf">0.008808234511422684</span><span class="p">,</span>
                <span class="mf">0.008254745457758155</span><span class="p">,</span> <span class="mf">0.007815979771853115</span><span class="p">,</span> <span class="mf">0.007225157857060406</span><span class="p">,</span> <span class="mf">0.006580363735558421</span><span class="p">,</span> <span class="mf">0.005937478092511996</span><span class="p">,</span> <span class="mf">0.005299415990797145</span><span class="p">,</span> 
                <span class="mf">0.004743698234230719</span><span class="p">,</span> <span class="mf">0.003942519682115882</span><span class="p">,</span> <span class="mf">0.003288264073460905</span><span class="p">,</span> <span class="mf">0.0026828299819035804</span><span class="p">,</span> <span class="mf">0.0021288202493691083</span><span class="p">,</span> <span class="mf">0.0016345630556029948</span><span class="p">,</span> 
                <span class="mf">0.001159406221958171</span><span class="p">,</span> <span class="mf">0.0034522484721209875</span><span class="p">]</span>
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">t_spar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">spar_thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">t_te</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">te_thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r_in</span><span class="p">)</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">raw_r</span><span class="p">,</span> <span class="n">raw_th</span><span class="p">)</span>
        <span class="n">thickness</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">r</span><span class="p">)</span>
        <span class="n">thickness</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="mf">100.0</span><span class="p">,</span> <span class="n">thickness</span><span class="p">)</span>

        <span class="c1"># Load airfoil polar files</span>
        <span class="n">afpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAeroPath</span><span class="p">()</span>
        <span class="c1"># af_thicknesses  = np.array([21.1, 24.1, 27.0, 30.1, 33.0, 36.0, 48.0, 60.0, 72.0, 100.0])</span>
        <span class="n">af_thicknesses</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">24.1</span><span class="p">,</span> <span class="mf">30.1</span><span class="p">,</span> <span class="mf">36.0</span><span class="p">,</span> <span class="mf">48.0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">])</span>
        <span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;FFA_W3_241.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;FFA_W3_301.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;FFA_W3_360.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;FFA_W3_480.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;FFA_W3_600.dat&#39;</span><span class="p">,</span> <span class="s1">&#39;Cylinder.dat&#39;</span><span class="p">]</span>
        <span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afpath</span><span class="p">,</span> <span class="n">af_file</span><span class="p">)</span> <span class="k">for</span> <span class="n">af_file</span> <span class="ow">in</span> <span class="n">airfoil_files</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_polars</span><span class="p">(</span><span class="n">thickness</span><span class="p">,</span> <span class="n">af_thicknesses</span><span class="p">,</span> <span class="n">airfoil_files</span><span class="p">)</span>

        <span class="c1"># Now set best guess at airfoil cordinates along span without interpolating like the polar (this is just for plotting)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">):</span>
            <span class="n">idx_thick</span>       <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">thickness</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">af_thicknesses</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">idx_thick</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">idx_thick</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">af_thicknesses</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">prefix</span>   <span class="o">=</span> <span class="s1">&#39;FFA_W3_&#39;</span>
                <span class="n">thickStr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="mi">10</span><span class="o">*</span><span class="n">af_thicknesses</span><span class="p">[</span><span class="n">idx_thick</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">prefix</span>   <span class="o">=</span> <span class="s1">&#39;Cylinder&#39;</span>
                <span class="n">thickStr</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">airfoil_files</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">afpath</span><span class="p">,</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">thickStr</span> <span class="o">+</span> <span class="s1">&#39;.dat&#39;</span><span class="p">)</span>



        <span class="c1"># Structural analysis inputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">le_location</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.499998945239</span><span class="p">,</span> <span class="mf">0.499990630963</span><span class="p">,</span> <span class="mf">0.499384561429</span><span class="p">,</span> <span class="mf">0.497733369567</span><span class="p">,</span> <span class="mf">0.489487054775</span><span class="p">,</span>
                                     <span class="mf">0.476975219349</span><span class="p">,</span> <span class="mf">0.458484322766</span><span class="p">,</span> <span class="mf">0.440125810719</span><span class="p">,</span> <span class="mf">0.422714559863</span><span class="p">,</span> <span class="mf">0.407975209714</span><span class="p">,</span>
                                     <span class="mf">0.395449769723</span><span class="p">,</span> <span class="mf">0.385287280879</span><span class="p">,</span> <span class="mf">0.376924554763</span><span class="p">,</span> <span class="mf">0.370088311651</span><span class="p">,</span> <span class="mf">0.364592902698</span><span class="p">,</span>
                                     <span class="mf">0.3602205136</span><span class="p">,</span> <span class="mf">0.356780489919</span><span class="p">,</span> <span class="mf">0.354039530035</span><span class="p">,</span> <span class="mf">0.351590005932</span><span class="p">,</span> <span class="mf">0.350233815248</span><span class="p">,</span> <span class="mf">0.350012355763</span><span class="p">,</span>
                                     <span class="mf">0.349988281626</span><span class="p">,</span> <span class="mf">0.350000251201</span><span class="p">,</span> <span class="mf">0.350002561185</span><span class="p">,</span> <span class="mf">0.350001421895</span><span class="p">,</span> <span class="mf">0.349997012891</span><span class="p">,</span> <span class="mf">0.350001029096</span><span class="p">,</span>
                                     <span class="mf">0.350000632518</span><span class="p">,</span> <span class="mf">0.349999297634</span><span class="p">,</span> <span class="mf">0.350000264157</span><span class="p">,</span> <span class="mf">0.350000005654</span><span class="p">,</span> <span class="mf">0.349999978357</span><span class="p">,</span> <span class="mf">0.349999995158</span><span class="p">,</span>
                                     <span class="mf">0.350000006591</span><span class="p">,</span> <span class="mf">0.349999999186</span><span class="p">,</span> <span class="mf">0.349999998202</span><span class="p">,</span> <span class="mf">0.350000000551</span><span class="p">,</span> <span class="mf">0.350000000029</span><span class="p">,</span> <span class="mf">0.349999999931</span><span class="p">,</span>
                                     <span class="mf">0.35000000004</span><span class="p">,</span> <span class="mf">0.350000000001</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.350000000001</span><span class="p">,</span> <span class="mf">0.349999999999</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">])</span>

        <span class="c1"># UPDATE when new composite layup is available</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_spar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sector_idx_strain_te</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">6</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">web1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.446529203227</span><span class="p">,</span> <span class="mf">0.446642686219</span><span class="p">,</span> <span class="mf">0.447230977047</span><span class="p">,</span> <span class="mf">0.449423527671</span><span class="p">,</span> <span class="mf">0.451384667298</span><span class="p">,</span> <span class="mf">0.45166085909</span><span class="p">,</span>
                              <span class="mf">0.445821859041</span><span class="p">,</span> <span class="mf">0.433601957075</span><span class="p">,</span> <span class="mf">0.414203341702</span><span class="p">,</span> <span class="mf">0.391111637325</span><span class="p">,</span> <span class="mf">0.367038887871</span><span class="p">,</span> <span class="mf">0.344148340044</span><span class="p">,</span>
                              <span class="mf">0.32264263023</span><span class="p">,</span> <span class="mf">0.303040717673</span><span class="p">,</span> <span class="mf">0.285780556269</span><span class="p">,</span> <span class="mf">0.271339581072</span><span class="p">,</span> <span class="mf">0.261077569528</span><span class="p">,</span> <span class="mf">0.254987877709</span><span class="p">,</span>
                              <span class="mf">0.250499030835</span><span class="p">,</span> <span class="mf">0.246801903789</span><span class="p">,</span> <span class="mf">0.243793928448</span><span class="p">,</span> <span class="mf">0.242362866767</span><span class="p">,</span> <span class="mf">0.241169996298</span><span class="p">,</span> <span class="mf">0.240114471242</span><span class="p">,</span>
                              <span class="mf">0.239138338743</span><span class="p">,</span> <span class="mf">0.238211240433</span><span class="p">,</span> <span class="mf">0.237380060299</span><span class="p">,</span> <span class="mf">0.236625908889</span><span class="p">,</span> <span class="mf">0.235947619537</span><span class="p">,</span> <span class="mf">0.235375269498</span><span class="p">,</span>
                              <span class="mf">0.234910524166</span><span class="p">,</span> <span class="mf">0.234573714458</span><span class="p">,</span> <span class="mf">0.23437656803</span><span class="p">,</span> <span class="mf">0.234323591937</span><span class="p">,</span> <span class="mf">0.234429396513</span><span class="p">,</span> <span class="mf">0.23469408391</span><span class="p">,</span>
                              <span class="mf">0.235090916602</span><span class="p">,</span> <span class="mf">0.235639910948</span><span class="p">,</span> <span class="mf">0.236359205424</span><span class="p">,</span> <span class="mf">0.237292044985</span><span class="p">,</span> <span class="mf">0.238468772012</span><span class="p">,</span> <span class="mf">0.239912928964</span><span class="p">,</span>
                              <span class="mf">0.241676539436</span><span class="p">,</span> <span class="mf">0.24378663077</span><span class="p">,</span> <span class="mf">0.246041897214</span><span class="p">,</span> <span class="mf">0.247824545238</span><span class="p">,</span> <span class="mf">0.248212620456</span><span class="p">,</span> <span class="mf">0.247666927859</span><span class="p">,</span>
                              <span class="mf">0.246627910571</span><span class="p">,</span> <span class="mf">0.154148714864</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.579105947595</span><span class="p">,</span> <span class="mf">0.579342815032</span><span class="p">,</span> <span class="mf">0.580624719333</span><span class="p">,</span> <span class="mf">0.585617777398</span><span class="p">,</span> <span class="mf">0.5905335998</span><span class="p">,</span> <span class="mf">0.592757384044</span><span class="p">,</span>
                              <span class="mf">0.587897774807</span><span class="p">,</span> <span class="mf">0.576668436742</span><span class="p">,</span> <span class="mf">0.557200875669</span><span class="p">,</span> <span class="mf">0.532380978251</span><span class="p">,</span> <span class="mf">0.505531782719</span><span class="p">,</span> <span class="mf">0.479744314701</span><span class="p">,</span>
                              <span class="mf">0.456216340946</span><span class="p">,</span> <span class="mf">0.43494475968</span><span class="p">,</span> <span class="mf">0.416533496674</span><span class="p">,</span> <span class="mf">0.40143144474</span><span class="p">,</span> <span class="mf">0.390766314857</span><span class="p">,</span> <span class="mf">0.384449528527</span><span class="p">,</span>
                              <span class="mf">0.379891695643</span><span class="p">,</span> <span class="mf">0.376232568599</span><span class="p">,</span> <span class="mf">0.373403485013</span><span class="p">,</span> <span class="mf">0.372223966271</span><span class="p">,</span> <span class="mf">0.371379269973</span><span class="p">,</span> <span class="mf">0.370759395854</span><span class="p">,</span>
                              <span class="mf">0.370295535294</span><span class="p">,</span> <span class="mf">0.36996224587</span><span class="p">,</span> <span class="mf">0.369789327231</span><span class="p">,</span> <span class="mf">0.36975863937</span><span class="p">,</span> <span class="mf">0.369855492121</span><span class="p">,</span> <span class="mf">0.370090120509</span><span class="p">,</span>
                              <span class="mf">0.370456638362</span><span class="p">,</span> <span class="mf">0.370955636744</span><span class="p">,</span> <span class="mf">0.371593427472</span><span class="p">,</span> <span class="mf">0.37236755247</span><span class="p">,</span> <span class="mf">0.373282787035</span><span class="p">,</span> <span class="mf">0.374330521266</span><span class="p">,</span>
                              <span class="mf">0.37548259513</span><span class="p">,</span> <span class="mf">0.376740794894</span><span class="p">,</span> <span class="mf">0.378108493317</span><span class="p">,</span> <span class="mf">0.379600043497</span><span class="p">,</span> <span class="mf">0.381225881051</span><span class="p">,</span> <span class="mf">0.382999965574</span><span class="p">,</span>
                              <span class="mf">0.384937055128</span><span class="p">,</span> <span class="mf">0.387054062586</span><span class="p">,</span> <span class="mf">0.389406784803</span><span class="p">,</span> <span class="mf">0.392151134201</span><span class="p">,</span> <span class="mf">0.395577451592</span><span class="p">,</span> <span class="mf">0.398541075929</span><span class="p">,</span>
                              <span class="mf">0.396140574221</span><span class="p">,</span> <span class="mf">0.377290889301</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="mf">0.883963623418</span><span class="p">,</span> <span class="mf">0.882804861283</span><span class="p">,</span>
                              <span class="mf">0.881764724203</span><span class="p">,</span> <span class="mf">0.880854972132</span><span class="p">,</span> <span class="mf">0.880063593261</span><span class="p">,</span> <span class="mf">0.879378185003</span><span class="p">,</span> <span class="mf">0.878797670205</span><span class="p">,</span> <span class="mf">0.878308574021</span><span class="p">,</span>
                              <span class="mf">0.87788500707</span><span class="p">,</span> <span class="mf">0.877514541845</span><span class="p">,</span> <span class="mf">0.877179551402</span><span class="p">,</span> <span class="mf">0.876879055</span><span class="p">,</span> <span class="mf">0.876610936666</span><span class="p">,</span> <span class="mf">0.876374235852</span><span class="p">,</span>
                              <span class="mf">0.876166483426</span><span class="p">,</span> <span class="mf">0.875986765133</span><span class="p">,</span> <span class="mf">0.875832594685</span><span class="p">,</span> <span class="mf">0.875702298474</span><span class="p">,</span> <span class="mf">0.875595140019</span><span class="p">,</span> <span class="mf">0.875508315318</span><span class="p">,</span>
                              <span class="mf">0.8754409845</span><span class="p">,</span> <span class="mf">0.875392657588</span><span class="p">,</span> <span class="mf">0.875361122776</span><span class="p">,</span> <span class="mf">0.875345560917</span><span class="p">,</span> <span class="mf">0.875342086256</span><span class="p">,</span> <span class="mf">0.875341086148</span><span class="p">,</span>
                              <span class="mf">0.875340761092</span><span class="p">,</span> <span class="mf">0.875339510238</span><span class="p">,</span> <span class="mf">0.875338477803</span><span class="p">,</span> <span class="mf">0.875337374186</span><span class="p">,</span> <span class="mf">0.875336204651</span><span class="p">,</span> <span class="mf">0.87533496247</span><span class="p">,</span>
                              <span class="mf">0.875333692251</span><span class="p">,</span> <span class="mf">0.875332490358</span><span class="p">,</span> <span class="mf">0.875331189455</span><span class="p">,</span> <span class="mf">0.875329175403</span><span class="p">,</span> <span class="mf">0.875324968372</span><span class="p">,</span> <span class="mf">0.875312750097</span><span class="p">,</span>
                              <span class="mf">0.875329970752</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">web4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
                              <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span>
                              <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
        
        
        <span class="c1"># Control</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vin</span>      <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_Vout</span>     <span class="o">=</span> <span class="mf">25.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_minOmega</span> <span class="o">=</span> <span class="mf">6.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_maxOmega</span> <span class="o">=</span> <span class="mf">90.0</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">bladeLength</span> <span class="o">*</span> <span class="p">(</span><span class="mf">60.0</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_tsr</span>      <span class="o">=</span> <span class="mf">10.58</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">control_pitch</span>    <span class="o">=</span> <span class="mf">0.0</span></div>
        

<div class="viewcode-block" id="BladeGeometry"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.BladeGeometry">[docs]</a><span class="k">class</span> <span class="nc">BladeGeometry</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RefBlade</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">BladeGeometry</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">RefBlade</span><span class="p">,</span> <span class="n">ReferenceBlade</span><span class="p">),</span> <span class="s1">&#39;Must pass in either NREL5MW or DTU10MW Reference Blade instance&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span> <span class="o">=</span> <span class="n">RefBlade</span>
        <span class="n">npts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">npts</span>
        
        <span class="c1"># variables</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;blade length (if not precurved or swept) otherwise length of blade before curvature&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;location of max chord on unit radius&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;chord_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;chord at control points&#39;</span><span class="p">)</span>  <span class="c1"># defined at hub, then at linearly spaced locations from r_max_chord to tip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;theta_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;twist at control points&#39;</span><span class="p">)</span>  <span class="c1"># defined at linearly spaced locations from r[idx_cylinder] to tip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;precurve at control points&#39;</span><span class="p">)</span>  <span class="c1"># defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;precurve at control points&#39;</span><span class="p">)</span>  <span class="c1"># defined at same locations at chord, starting at 2nd control point (root must be zero precurve)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;thickness values of spar cap that linearly vary from non-cylinder position to tip&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;teT_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;thickness values of trailing edge panels that linearly vary from non-cylinder position to tip&#39;</span><span class="p">)</span>

        <span class="c1"># parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;hub location as fraction of radius&#39;</span><span class="p">)</span>

        <span class="c1"># Blade geometry outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Rhub&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;dimensional radius of hub&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;Rtip&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;dimensional radius of tip&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;r_pts&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;dimensional aerodynamic grid&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;r_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Spline control points for inputs&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;max_chord&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;maximum chord length&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;chord&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;chord at airfoil locations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;twist at airfoil locations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;precurve&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;precurve at airfoil locations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;presweep&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;presweep at structural locations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;sparT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;dimensional spar cap thickness distribution&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;teT&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;dimensional trailing-edge panel thickness distribution&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;hub_diameter&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;airfoils&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="p">[],</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Spanwise coordinates for aerodynamic analysis&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;le_location&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Leading-edge positions from a reference blade axis (usually blade pitch axis). Locations are normalized by the local chord length. Positive in -x direction for airfoil-aligned coordinate system&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;chord_ref&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Chord distribution for reference section, thickness of structural layup scaled with reference thickness (fixed t/c)&#39;</span><span class="p">)</span>

        <span class="c1"># Blade layup outputs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;materials&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;material properties of composite materials&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;upperCS&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;list of CompositeSection objections defining the properties for upper surface&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;lowerCS&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;list of CompositeSection objections defining the properties for lower surface&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;websCS&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;list of CompositeSection objections defining the properties for shear webs&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;profile&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;list of CompositeSection profiles&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;sector_idx_strain_spar&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Index of sector for spar (PreComp definition of sector)&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;sector_idx_strain_te&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Index of sector for trailing edge (PreComp definition of sector)&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fd&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;step_calc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relative&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;form&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;central&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;check_form&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;central&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;step_size&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-5</span>
        
    <span class="k">def</span> <span class="nf">solve_nonlinear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">,</span> <span class="n">resids</span><span class="p">):</span>

        <span class="n">Rhub</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span>
        <span class="n">Rtip</span> <span class="o">=</span> <span class="n">Rhub</span> <span class="o">+</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">]</span>

        <span class="c1"># make dimensional and evaluate splines</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;Rhub&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">Rhub</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;Rtip&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">Rtip</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;hub_diameter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">Rhub</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">Rhub</span> <span class="o">+</span> <span class="p">(</span><span class="n">Rtip</span><span class="o">-</span><span class="n">Rhub</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">r</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">]</span>     <span class="o">=</span> <span class="n">Rhub</span> <span class="o">+</span> <span class="p">(</span><span class="n">Rtip</span><span class="o">-</span><span class="n">Rhub</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">r_cylinder</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">NINPUT</span><span class="o">-</span><span class="mi">2</span><span class="p">)]</span>

        <span class="c1"># Although the inputs get mirrored to outputs, this is still necessary so that the user can designate the inputs as design variables</span>
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;chord_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;max_chord&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">Rhub</span> <span class="o">+</span> <span class="p">(</span><span class="n">Rtip</span><span class="o">-</span><span class="n">Rhub</span><span class="p">)</span><span class="o">*</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;chord&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;theta_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;theta&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;precurve&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;presweep&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>

        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;sparT&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>
        
        <span class="n">myspline</span> <span class="o">=</span> <span class="n">Akima</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_in&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;teT_in&#39;</span><span class="p">])</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;teT&#39;</span><span class="p">],</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">myspline</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;r_pts&#39;</span><span class="p">])</span>
        
        <span class="c1"># Setup paths</span>
        <span class="n">strucpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">getStructPath</span><span class="p">()</span>
        <span class="n">materials</span> <span class="o">=</span> <span class="n">Orthotropic2DMaterial</span><span class="o">.</span><span class="n">listFromPreCompFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strucpath</span><span class="p">,</span> <span class="s1">&#39;materials.inp&#39;</span><span class="p">))</span>

        <span class="c1"># Now compute some layup properties, independent of which turbine it is</span>
        <span class="n">npts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">npts</span>
        <span class="n">upperCS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">npts</span>
        <span class="n">lowerCS</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">npts</span>
        <span class="n">websCS</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">npts</span>
        <span class="n">profile</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">npts</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npts</span><span class="p">):</span>
            <span class="n">webLoc</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web1</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">webLoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web1</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web2</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">webLoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web2</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web3</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">webLoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web3</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web4</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span> <span class="n">webLoc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">web4</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

            <span class="n">istr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;5MW&#39;</span> <span class="k">else</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">upperCS</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lowerCS</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">websCS</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">CompositeSection</span><span class="o">.</span><span class="n">initFromPreCompLayupFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strucpath</span><span class="p">,</span> <span class="s1">&#39;layup_&#39;</span> <span class="o">+</span> <span class="n">istr</span> <span class="o">+</span> <span class="s1">&#39;.inp&#39;</span><span class="p">),</span> <span class="n">webLoc</span><span class="p">,</span> <span class="n">materials</span><span class="p">)</span>
            <span class="n">profile</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Profile</span><span class="o">.</span><span class="n">initFromPreCompFile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">strucpath</span><span class="p">,</span> <span class="s1">&#39;shape_&#39;</span> <span class="o">+</span> <span class="n">istr</span> <span class="o">+</span> <span class="s1">&#39;.inp&#39;</span><span class="p">))</span>

        <span class="c1"># Assign outputs</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;airfoils&#39;</span><span class="p">]</span>          <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">airfoils</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;le_location&#39;</span><span class="p">]</span>            <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">le_location</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;upperCS&#39;</span><span class="p">]</span>                <span class="o">=</span> <span class="n">upperCS</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;lowerCS&#39;</span><span class="p">]</span>                <span class="o">=</span> <span class="n">lowerCS</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;websCS&#39;</span><span class="p">]</span>                 <span class="o">=</span> <span class="n">websCS</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;profile&#39;</span><span class="p">]</span>                <span class="o">=</span> <span class="n">profile</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;chord_ref&#39;</span><span class="p">]</span>              <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">chord_ref</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;sector_idx_strain_spar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">sector_idx_strain_spar</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;sector_idx_strain_te&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">refBlade</span><span class="o">.</span><span class="n">sector_idx_strain_te</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;materials&#39;</span><span class="p">]</span>              <span class="o">=</span> <span class="n">materials</span></div>
        
        
<div class="viewcode-block" id="Location"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.Location">[docs]</a><span class="k">class</span> <span class="nc">Location</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Location</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;hub_height&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Tower top hub height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;wind_zvec&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Tower top hub height as vector&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fd&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;step_calc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relative&#39;</span>

    <span class="k">def</span> <span class="nf">solve_nonlinear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">,</span> <span class="n">resids</span><span class="p">):</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;wind_zvec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;hub_height&#39;</span><span class="p">]</span> <span class="p">])</span></div>


        
<div class="viewcode-block" id="TurbineClass"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.TurbineClass">[docs]</a><span class="k">class</span> <span class="nc">TurbineClass</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TurbineClass</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_param</span><span class="p">(</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;IEC turbine class&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># outputs should be constant</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;V_mean&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;IEC mean wind speed for Rayleigh distribution&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;V_extreme&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;IEC extreme wind speed at hub height&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_output</span><span class="p">(</span><span class="s1">&#39;V_extreme_full&#39;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m/s&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;IEC extreme wind speed at hub height&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;fd&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deriv_options</span><span class="p">[</span><span class="s1">&#39;step_calc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;relative&#39;</span>

    <span class="k">def</span> <span class="nf">solve_nonlinear</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">unknowns</span><span class="p">,</span> <span class="n">resids</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">==</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">]:</span>
            <span class="n">Vref</span> <span class="o">=</span> <span class="mf">50.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">==</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;II&#39;</span><span class="p">]:</span>
            <span class="n">Vref</span> <span class="o">=</span> <span class="mf">42.5</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">==</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;III&#39;</span><span class="p">]:</span>
            <span class="n">Vref</span> <span class="o">=</span> <span class="mf">37.5</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbine_class</span> <span class="o">==</span> <span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;IV&#39;</span><span class="p">]:</span>
            <span class="n">Vref</span> <span class="o">=</span> <span class="mf">30.0</span>

        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;V_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span><span class="o">*</span><span class="n">Vref</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;V_extreme&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">Vref</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;V_extreme_full&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">Vref</span> <span class="c1"># for extreme cases TODO: check if other way to do</span>
        <span class="n">unknowns</span><span class="p">[</span><span class="s1">&#39;V_extreme_full&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.4</span><span class="o">*</span><span class="n">Vref</span></div>



<div class="viewcode-block" id="RotorGeometry"><a class="viewcode-back" href="../../documentation.html#rotorse.rotor_geometry.RotorGeometry">[docs]</a><span class="k">class</span> <span class="nc">RotorGeometry</span><span class="p">(</span><span class="n">Group</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">RefBlade</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RotorGeometry</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;rotor model&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">RefBlade</span><span class="p">,</span> <span class="n">ReferenceBlade</span><span class="p">),</span> <span class="s1">&#39;Must pass in either NREL5MW or DTU10MW Reference Blade instance&#39;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;bladeLength&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;hubFraction&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;r_max_chord&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;chord_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;chord_in&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span><span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;theta_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;theta_in&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;precurve_in&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;precurve_tip&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;precurve_tip&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;presweep_in&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;presweep_tip&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;presweep_tip&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;precone&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;precone&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;tilt&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;yaw&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;yaw&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;nBlades&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;nBlades&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">TURBINE_CLASS</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">],</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;IEC turbine class&#39;</span><span class="p">,</span> <span class="n">pass_by_obj</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        
        <span class="c1"># --- composite sections ---</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;sparT_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;spar cap thickness parameters&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;teT_in&#39;</span><span class="p">,</span> <span class="n">IndepVarComp</span><span class="p">(</span><span class="s1">&#39;teT_in&#39;</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NINPUT</span><span class="p">),</span> <span class="n">units</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;trailing-edge thickness parameters&#39;</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        
        <span class="c1"># --- Rotor Definition ---</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;loc&#39;</span><span class="p">,</span> <span class="n">Location</span><span class="p">(),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;turbineclass&#39;</span><span class="p">,</span> <span class="n">TurbineClass</span><span class="p">())</span>
        <span class="c1">#self.add(&#39;spline0&#39;, BladeGeometry(RefBlade))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;spline&#39;</span><span class="p">,</span> <span class="n">BladeGeometry</span><span class="p">(</span><span class="n">RefBlade</span><span class="p">),</span> <span class="n">promotes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;*&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;geom&#39;</span><span class="p">,</span> <span class="n">CCBladeGeometry</span><span class="p">())</span>

        <span class="c1"># connections to turbineclass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;turbine_class&#39;</span><span class="p">,</span> <span class="s1">&#39;turbineclass.turbine_class&#39;</span><span class="p">)</span>

        <span class="c1"># connections to spline0</span>
        <span class="c1">#self.connect(&#39;r_max_chord&#39;, &#39;spline0.r_max_chord&#39;)</span>
        <span class="c1">#self.connect(&#39;chord_in&#39;, &#39;spline0.chord_in&#39;)</span>
        <span class="c1">#self.connect(&#39;theta_in&#39;, &#39;spline0.theta_in&#39;)</span>
        <span class="c1">#self.connect(&#39;precurve_in&#39;, &#39;spline0.precurve_in&#39;)</span>
        <span class="c1">#self.connect(&#39;presweep_in&#39;, &#39;spline0.presweep_in&#39;)</span>
        <span class="c1">#self.connect(&#39;bladeLength&#39;, &#39;spline0.bladeLength&#39;)</span>
        <span class="c1">#self.connect(&#39;hubFraction&#39;, &#39;spline0.hubFraction&#39;)</span>
        <span class="c1">#self.connect(&#39;sparT_in&#39;, &#39;spline0.sparT_in&#39;)</span>
        <span class="c1">#self.connect(&#39;teT_in&#39;, &#39;spline0.teT_in&#39;)</span>

        <span class="c1"># connections to spline</span>
        <span class="c1">#self.connect(&#39;r_max_chord&#39;, &#39;spline.r_max_chord&#39;)</span>
        <span class="c1">#self.connect(&#39;chord_in&#39;, &#39;spline.chord_in&#39;)</span>
        <span class="c1">#self.connect(&#39;theta_in&#39;, &#39;spline.theta_in&#39;)</span>
        <span class="c1">#self.connect(&#39;precurve_in&#39;, &#39;spline.precurve_in&#39;)</span>
        <span class="c1">#self.connect(&#39;presweep_in&#39;, &#39;spline.presweep_in&#39;)</span>
        <span class="c1">#self.connect(&#39;bladeLength&#39;, &#39;spline.bladeLength&#39;)</span>
        <span class="c1">#self.connect(&#39;hubFraction&#39;, &#39;spline.hubFraction&#39;)</span>
        <span class="c1">#self.connect(&#39;sparT_in&#39;, &#39;spline.sparT_in&#39;)</span>
        <span class="c1">#self.connect(&#39;teT_in&#39;, &#39;spline.teT_in&#39;)</span>

        <span class="c1"># connections to geom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;Rtip&#39;</span><span class="p">,</span> <span class="s1">&#39;geom.Rtip&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;precone&#39;</span><span class="p">,</span> <span class="s1">&#39;geom.precone&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;precurve_tip&#39;</span><span class="p">,</span> <span class="s1">&#39;geom.precurveTip&#39;</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>

    <span class="n">refBlade</span> <span class="o">=</span> <span class="n">DTU10MW</span><span class="p">()</span>
    <span class="n">refBlade</span> <span class="o">=</span> <span class="n">NREL5MW</span><span class="p">()</span>
    <span class="n">rotor</span> <span class="o">=</span> <span class="n">RotorGeometry</span><span class="p">(</span><span class="n">refBlade</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RotorSE 0.1.0 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, NREL.
      Last updated on Jul 05, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>